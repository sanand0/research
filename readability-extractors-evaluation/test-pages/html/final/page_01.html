<!DOCTYPE html><script type="module" src="/_astro/index.astro_astro_type_script_index_0_lang.CoXd8L9s.js"></script> <html lang="en-us" dir="ltr"> <head><meta charset="UTF-8"><script async src="https://ot.www.cloudflare.com/public/vendor/onetrust/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" data-domain-script="b1e05d49-f072-4bae-9116-bdb78af15448"></script><script type="text/javascript">
    window.loadScript = (url, { charset = 'UTF-8', ...attributes } = {}, location = 'head') => {
      const existingScript = document.querySelector('script[src="' + url + '"]');
      if (existingScript) {
        return;
      }

      const script = document.createElement('script');
      script.src = url;
      script.type = 'text/javascript';

      script.async = true;
      script.charset = charset;

      if (attributes) {
        Object.entries(attributes).forEach(([key, value]) => {
          script.setAttribute(key, value);
        });
      }

      if (location === 'head') {
        document.head.appendChild(script);
      } else {
        document.body.appendChild(script);
      }

      return script;
    };
  </script><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="baidu-site-verification" content="KeThzeyMOr"><meta name="baidu-site-verification" content="code-NIlrS7gNhx"><meta name="description" content="Over the past couple of weeks, Cloudflare's DDoS protection systems have automatically and successfully mitigated multiple hyper-volumetric L3/4 DDoS attacks exceeding 3 billion packets per second (Bpps). Our systems also automatically mitigated multiple attacks exceeding 3 terabits per second (Tbps), with the largest ones exceeding 3.65 Tbps. The scale of these attacks is unprecedented."><title>How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack</title><meta name="title" content="How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack"><meta name="msvalidate.01" content="CF295E1604697F9CAD18B5A232E871F6"><meta class="swiftype" name="language" data-type="string" content="en"><script type="text/javascript">
    function OptanonWrapper() {
      if (!window.zarazTagManager.loaded && window.OnetrustActiveGroups.includes('C0004')) {
        window.zarazTagManager.loadZaraz();
      }

      if (window.zaraz && !window.OnetrustActiveGroups.includes('C0004')) {
        window.zaraz = undefined;
        window.zarazData = undefined;
        window.zarazTagManager.loaded = false;
      }

      if (!window.isCfCookieEventAttached) {
        window.isCfCookieEventAttached = true;
        window.addEventListener('consent.onetrust', async () => {
          await fetch('/', { method: 'HEAD' });
        });
      }
    }
    window.zarazTagManager = {
      loaded: false,
      getEndPoint() {
        return '/static/z/i.js';
      },
      loadZaraz() {
        window.loadScript(window.zarazTagManager.getEndPoint());
        window.zarazTagManager.loaded = true;
      },
    };
  </script><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-32x32.png"><link rel="mask-icon" href="/images/favicon-32x32.png" color="#f78100"><link rel="stylesheet" href="/themes/ashes.min.css"><link rel="sitemap" href="/sitemap.xml"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><link rel="canonical" href="https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="en-us" href="https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="zh-cn" href="https://blog.cloudflare.com/zh-cn/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="zh-tw" href="https://blog.cloudflare.com/zh-tw/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="fr-fr" href="https://blog.cloudflare.com/fr-fr/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="de-de" href="https://blog.cloudflare.com/de-de/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="ja-jp" href="https://blog.cloudflare.com/ja-jp/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="ko-kr" href="https://blog.cloudflare.com/ko-kr/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="pt-br" href="https://blog.cloudflare.com/pt-br/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><link rel="alternate" hreflang="es-es" href="https://blog.cloudflare.com/es-es/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><!-- General Meta Tags --><meta property="article:published_time" content="2024-10-02T14:00+01:00"><meta property="article:modified_time" content="2025-10-24T09:50:20.565Z"><meta property="article:tag" content="DDoS"><meta property="article:tag" content="Attacks"><meta property="article:tag" content="Trends"><meta property="article:tag" content="Security"><meta property="article:publisher" content="https://www.facebook.com/cloudflare"><!-- Facebook Meta Tags --><meta property="og:site_name" content="The Cloudflare Blog"><meta property="og:type" content="article"><meta property="og:title" content="How Cloudflare auto-mitigated a world record 3.8 Tbps DDoS attack"><meta property="og:description" content="Cloudflare’s DDoS defenses have automatically and successfully detected and mitigated a 3.8 terabit per second DDoS attack — the largest attack on record — as part of a month-long campaign of over a hundred hyper-volumetric L3/4 DDoS attacks.
"><meta property="og:url" content="https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="628"><!-- Twitter/X Meta Tags --><meta name="twitter:title" content="How Cloudflare auto-mitigated a world record 3.8 Tbps DDoS attack"><meta name="twitter:description" content="Cloudflare’s DDoS defenses have automatically and successfully detected and mitigated a 3.8 terabit per second DDoS attack — the largest attack on record — as part of a month-long campaign of over a hundred hyper-volumetric L3/4 DDoS attacks.
"><meta name="twitter:url" content="https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:label1" content="Written by"><meta name="twitter:data1" content="Manish Arora"><meta name="twitter:label2" content="Filed under"><meta name="twitter:data2" content="DDoS,Attacks,Trends,Security"><meta name="twitter:site" content="@cloudflare"><meta property="og:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7pofsKkChZMjVLdvsjg7s8/02b958f5283cb17ae4a3ab17b1dae63a/BLOG-2586_OG.png"><meta name="twitter:image" content="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7pofsKkChZMjVLdvsjg7s8/02b958f5283cb17ae4a3ab17b1dae63a/BLOG-2586_OG.png"><link rel="stylesheet" href="/_astro/index.BriTMC_o.css">
<style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style></head><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).only=e;window.dispatchEvent(new Event("astro:only"));})();;(()=>{var A=Object.defineProperty;var g=(i,o,a)=>o in i?A(i,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[o]=a;var d=(i,o,a)=>g(i,typeof o!="symbol"?o+"":o,a);{let i={0:t=>m(t),1:t=>a(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(a(t)),5:t=>new Set(a(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t),11:t=>1/0*t},o=t=>{let[l,e]=t;return l in i?i[l](e):void 0},a=t=>t.map(o),m=t=>typeof t!="object"||t===null?t:Object.fromEntries(Object.entries(t).map(([l,e])=>[l,o(e)]));class y extends HTMLElement{constructor(){super(...arguments);d(this,"Component");d(this,"hydrator");d(this,"hydrate",async()=>{var b;if(!this.hydrator||!this.isConnected)return;let e=(b=this.parentElement)==null?void 0:b.closest("astro-island[ssr]");if(e){e.addEventListener("astro:hydrate",this.hydrate,{once:!0});return}let c=this.querySelectorAll("astro-slot"),n={},h=this.querySelectorAll("template[data-astro-template]");for(let r of h){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("data-astro-template")||"default"]=r.innerHTML,r.remove())}for(let r of c){let s=r.closest(this.tagName);s!=null&&s.isSameNode(this)&&(n[r.getAttribute("name")||"default"]=r.innerHTML)}let p;try{p=this.hasAttribute("props")?m(JSON.parse(this.getAttribute("props"))):{}}catch(r){let s=this.getAttribute("component-url")||"<unknown>",v=this.getAttribute("component-export");throw v&&(s+=` (export ${v})`),console.error(`[hydrate] Error parsing props for component ${s}`,this.getAttribute("props"),r),r}let u;await this.hydrator(this)(this.Component,p,n,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))});d(this,"unmount",()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))})}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(!this.hasAttribute("await-children")||document.readyState==="interactive"||document.readyState==="complete")this.childrenConnectedCallback();else{let e=()=>{document.removeEventListener("DOMContentLoaded",e),c.disconnect(),this.childrenConnectedCallback()},c=new MutationObserver(()=>{var n;((n=this.lastChild)==null?void 0:n.nodeType)===Node.COMMENT_NODE&&this.lastChild.nodeValue==="astro:end"&&(this.lastChild.remove(),e())});c.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",e)}}async childrenConnectedCallback(){let e=this.getAttribute("before-hydration-url");e&&await import(e),this.start()}async start(){let e=JSON.parse(this.getAttribute("opts")),c=this.getAttribute("client");if(Astro[c]===void 0){window.addEventListener(`astro:${c}`,()=>this.start(),{once:!0});return}try{await Astro[c](async()=>{let n=this.getAttribute("renderer-url"),[h,{default:p}]=await Promise.all([import(this.getAttribute("component-url")),n?import(n):()=>()=>{}]),u=this.getAttribute("component-export")||"default";if(!u.includes("."))this.Component=h[u];else{this.Component=h;for(let f of u.split("."))this.Component=this.Component[f]}return this.hydrator=p,this.hydrate},e,this)}catch(n){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,n)}}attributeChangedCallback(){this.hydrate()}}d(y,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",y)}})();</script><astro-island uid="2cWtcI" component-url="/_astro/GoogleAnalytics.O41kpLbs.js" component-export="GoogleAnalytics" renderer-url="/_astro/client.CI64Qvmy.js" props="{&quot;title&quot;:[0,&quot;How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack&quot;],&quot;canonical&quot;:[0,&quot;https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack&quot;],&quot;info&quot;:[0,{&quot;id&quot;:[0,&quot;4j6QWqeVFn6qzs0Md0LK7h&quot;],&quot;title&quot;:[0,&quot;How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack&quot;],&quot;slug&quot;:[0,&quot;how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack&quot;],&quot;excerpt&quot;:[0,&quot;Over the past couple of weeks, Cloudflare&#39;s DDoS protection systems have automatically and successfully mitigated multiple hyper-volumetric L3/4 DDoS attacks exceeding 3 billion packets per second (Bpps). Our systems also automatically mitigated multiple attacks exceeding 3 terabits per second (Tbps), with the largest ones exceeding 3.65 Tbps. The scale of these attacks is unprecedented.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Since early September, &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/about/components/#autonomous-edge\&quot;&gt;&lt;u&gt;Cloudflare&amp;#39;s DDoS protection systems&lt;/u&gt;&lt;/a&gt; have been combating a month-long campaign of hyper-volumetric L3/4 DDoS attacks. Cloudflare’s defenses mitigated over one hundred hyper-volumetric L3/4 DDoS attacks throughout the month, with many exceeding 2 billion packets per second (Bpps) and 3 terabits per second (Tbps). The largest attack peaked 3.8 Tbps — the largest ever disclosed publicly by any organization. Detection and mitigation was fully autonomous. The graphs below represent two separate attack events that targeted the same Cloudflare customer and were mitigated autonomously.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7hXUgmEd37kzZrMs0KPXLl/21a4779022bdff91f760dc66759eb955/BLOG-2586_2.png\&quot; alt=\&quot;BLOG-2586 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;922\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;A mitigated 3.8 Terabits per second DDoS attack that lasted 65 seconds&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1uxvtlkdFoH6KU6waXxK3o/d17fe7cf0e33c20e64a47b3ca0e6ca63/BLOG-2586_3.png\&quot; alt=\&quot;BLOG-2586 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1076\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;A mitigated 2.14 billion packet per second DDoS attack that lasted 60 seconds&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;cloudflare-customers-are-protected\&quot;&gt;Cloudflare customers are protected&lt;/h2&gt;\n      &lt;a href=\&quot;#cloudflare-customers-are-protected\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Cloudflare customers using Cloudflare’s HTTP reverse proxy services (e.g. &lt;a href=\&quot;https://developers.cloudflare.com/waf/\&quot;&gt;&lt;u&gt;Cloudflare WAF&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/cache/\&quot;&gt;&lt;u&gt;Cloudflare CDN&lt;/u&gt;&lt;/a&gt;) are automatically protected.&lt;/p&gt;&lt;p&gt;Cloudflare customers using &lt;a href=\&quot;https://developers.cloudflare.com/spectrum/\&quot;&gt;&lt;u&gt;Spectrum&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/magic-transit/\&quot;&gt;&lt;u&gt;Magic Transit&lt;/u&gt;&lt;/a&gt; are also automatically protected. Magic Transit customers can further optimize their protection by deploying &lt;a href=\&quot;https://developers.cloudflare.com/magic-firewall/\&quot;&gt;&lt;u&gt;Magic Firewall&lt;/u&gt;&lt;/a&gt; rules to enforce a strict positive and negative security model at the packet layer.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;other-internet-properties-may-not-be-safe\&quot;&gt;Other Internet properties may not be safe&lt;/h2&gt;\n      &lt;a href=\&quot;#other-internet-properties-may-not-be-safe\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The scale and frequency of these attacks are unprecedented. Due to their sheer size and bits/packets per second rates, these attacks have the ability to take down unprotected Internet properties, as well as Internet properties that are protected by on-premise equipment or by cloud providers that just don’t have sufficient network capacity or global coverage to be able to handle these volumes alongside legitimate traffic without impacting performance. &lt;/p&gt;&lt;p&gt;Cloudflare, however, does have the network capacity, global coverage, and intelligent systems needed to absorb and automatically mitigate these monstrous attacks. &lt;/p&gt;&lt;p&gt;In this blog post, we will review the attack campaign and why its attacks are so severe. We will describe the anatomy of a Layer 3/4 DDoS attack, its objectives, and how attacks are generated. We will then proceed to detail how Cloudflare’s systems were able to autonomously detect and mitigate these monstrous attacks without impacting performance for our customers. We will describe the key aspects of our defenses, starting with how our systems generate real-time (dynamic) signatures to match the attack traffic all the way to how we leverage kernel features to drop packets at wire-speed.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;campaign-analysis\&quot;&gt;Campaign analysis&lt;/h2&gt;\n      &lt;a href=\&quot;#campaign-analysis\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We have observed this attack campaign targeting multiple customers in the financial services, Internet, and telecommunication industries, among others. This attack campaign targets bandwidth saturation as well as resource exhaustion of in-line applications and devices.&lt;/p&gt;&lt;p&gt;The attacks predominantly leverage &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/\&quot;&gt;&lt;u&gt;UDP&lt;/u&gt;&lt;/a&gt; on a fixed port, and originated from across the globe with larger shares coming from Vietnam, Russia, Brazil, Spain, and the US. &lt;/p&gt;&lt;p&gt;The high packet rate attacks appear to originate from multiple types of compromised devices, including MikroTik devices, DVRs, and Web servers, orchestrated to work in tandem and flood the target with exceptionally large volumes of traffic. The high bitrate attacks appear to originate from a large number of compromised ASUS home routers, likely exploited using &lt;a href=\&quot;https://censys.com/june-20-improper-authentication-vulnerability-in-asus-routers/\&quot;&gt;&lt;u&gt;a CVE 9.8 (Critical) vulnerability that was recently discovered by Censys&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;div style=\&quot;margin-left:0pt;\&quot; dir=\&quot;ltr\&quot; align=\&quot;left\&quot;&gt;\n    &lt;figure class=\&quot;table\&quot;&gt;\n        &lt;table class=\&quot;ck-table-resized\&quot; style=\&quot;border-collapse:collapse;border-style:none;\&quot;&gt;\n            &lt;colgroup&gt;\n                &lt;col style=\&quot;width:50%;\&quot; width=\&quot;344\&quot;&gt;\n                &lt;col style=\&quot;width:50%;\&quot; width=\&quot;100\&quot;&gt;\n            &lt;/colgroup&gt;\n            &lt;tbody&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Russia&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;12.1%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Vietnam&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;11.6%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;United States&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;9.3%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Spain&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;6.5%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Brazil&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;4.7%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;France&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;4.7%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Romania&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;4.4%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Taiwan&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;3.4%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:19.5pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;United Kingdom&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;3.3%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Italy&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;2.8%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/tbody&gt;\n        &lt;/table&gt;\n    &lt;/figure&gt;\n&lt;/div&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Share of packets observed by source location&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;anatomy-of-ddos-attacks\&quot;&gt;Anatomy of DDoS attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#anatomy-of-ddos-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Before we discuss how Cloudflare automatically detected and mitigated the largest DDoS attacks ever seen, it‘s important to understand the basics of DDoS attacks. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7HLtAHnyjS33iiJAR1B9h9/2e1fc2cab871440fc95fa803989ae156/BLOG-2586_5.png\&quot; alt=\&quot;BLOG-2586 5\&quot; class=\&quot;kg-image\&quot; width=\&quot;1190\&quot; height=\&quot;830\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Simplified diagram of a DDoS attack&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;The goal of a &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/\&quot;&gt;&lt;u&gt;Distributed Denial of Service (DDoS) attack&lt;/u&gt;&lt;/a&gt; is to deny legitimate users access to a service. This is usually done by exhausting resources needed to provide the service. In the context of these recent Layer 3/4 DDoS attacks, that resource is CPU cycles and network bandwidth.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;exhausting-cpu-cycles\&quot;&gt;Exhausting CPU cycles&lt;/h3&gt;\n      &lt;a href=\&quot;#exhausting-cpu-cycles\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Processing a packet consumes CPU cycles. In the case of regular (non-attack) traffic, a &lt;i&gt;legitimate&lt;/i&gt; packet received by a service will cause that service to perform some action, and different actions require different amounts of CPU processing. However, before a packet is even delivered to a service there is per-packet work that needs to be done. Layer 3 packet headers need to be parsed and processed to deliver the packet to the correct machine and interface. Layer 4 packet headers need to be processed and routed to the correct socket (if any). There may be multiple additional processing steps that inspect every packet. Therefore, if an attacker sends at a high enough packet rate, then they can potentially saturate the available CPU resources, denying service to legitimate users.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3aBbNG4Fc7TY6MTugLl3BE/064fb17761aebbce737a5a4518a14235/BLOG-2586_6.png\&quot; alt=\&quot;BLOG-2586 6\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;To defend against high packet rate attacks, you need to be able to inspect and discard the bad packets using as few CPU cycles as possible, leaving enough CPU to process the good packets. You can additionally acquire more, or faster, CPUs to perform the processing — but that can be a very lengthy process that bears high costs. &lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;exhausting-network-bandwidth\&quot;&gt;Exhausting network bandwidth&lt;/h3&gt;\n      &lt;a href=\&quot;#exhausting-network-bandwidth\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Network bandwidth is the total amount of data per time that can be delivered to a server. You can think of bandwidth like a pipe to transport water. The amount of water we can deliver through a drinking straw is less than what we could deliver through a garden hose. If an attacker is able to push more garbage data into the pipe than it can deliver, then both the bad data &lt;i&gt;and&lt;/i&gt; the good data will be discarded upstream, at the entrance to the pipe, and the DDoS is therefore successful.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/OehVItOhGfP9ApllRvDDM/fce73e6f375173a1a53bc22026e0b9b1/BLOG-2586_7.png\&quot; alt=\&quot;BLOG-2586 7\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;\nDefending against attacks that can saturate network bandwidth can be difficult because there is very little that can be done if you are on the downstream side of the saturated pipe. There are really only a few choices: you can get a bigger pipe, you can potentially find a way to move the good traffic to a new pipe that isn’t saturated, or you can hopefully ask the upstream side of the pipe to stop sending some or all of the data into the pipe.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;generating-ddos-attacks\&quot;&gt;Generating DDoS attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#generating-ddos-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;If we think about what this means from the attackers point of view you realize there are similar constraints. Just as it takes CPU cycles to receive a packet, it also takes CPU cycles to create a packet. If, for example, the cost to send and receive a packet were equal, then the attacker would need an equal amount of CPU power to generate the attack as we would need to defend against it. In most cases this is not true — there is a cost asymmetry, as the attacker is able to generate packets using fewer CPU cycles than it takes to receive those packets. However, it is worth noting that generating attacks is not free and can require a large amount of CPU power.&lt;/p&gt;&lt;p&gt;Saturating network bandwidth can be even more difficult for an attacker. Here the attacker needs to be able to output more bandwidth than the target service has allocated. They actually need to be able to exceed the capacity of the receiving service. This is so difficult that the most common way to achieve a network bandwidth attack is to use a reflection/amplification attack method, for example a &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/\&quot;&gt;&lt;u&gt;DNS Amplification attack&lt;/u&gt;&lt;/a&gt;. These attacks allow the attacker to send a small packet to an intermediate service, and the intermediate service will send a large packet to the victim.&lt;/p&gt;&lt;p&gt;In both scenarios, the attacker needs to acquire or gain access to many devices to generate the attack. These devices can be acquired in a number of different ways. They may be server class machines from cloud providers or hosting services, or they can be compromised devices like DVRs, routers, and webcams that have been infected with the attacker’s malware. These machines together form the botnet.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;how-cloudflare-defends-against-large-attacks\&quot;&gt;How Cloudflare defends against large attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#how-cloudflare-defends-against-large-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Now that we understand the fundamentals of how DDoS attacks work, we can explain how Cloudflare can defend against these attacks.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;spreading-the-attack-surface-using-global-anycast\&quot;&gt;Spreading the attack surface using global anycast&lt;/h3&gt;\n      &lt;a href=\&quot;#spreading-the-attack-surface-using-global-anycast\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The first not-so-secret ingredient is that Cloudflare’s network is built on &lt;a href=\&quot;https://www.cloudflare.com/learning/cdn/glossary/anycast-network/\&quot;&gt;&lt;u&gt;anycast&lt;/u&gt;&lt;/a&gt;. In brief, anycast allows a single IP address to be advertised by multiple machines around the world. A packet sent to that IP address will be served by the closest machine. This means when an attacker uses their distributed botnet to launch an attack, the attack will be received in a distributed manner across the Cloudflare network. An infected DVR in Dallas, Texas will send packets to a Cloudflare server in Dallas. An infected webcam in London will send packets to a Cloudflare server in London.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/48tW6A6ACUT4Fd9h3l70F4/c6bcea8f037fc853477d0987c939e007/BLOG-2586_8.png\&quot; alt=\&quot;BLOG-2586 8\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1880\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Anycast vs. Unicast networks&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;Our anycast network additionally allows Cloudflare to allocate compute and bandwidth resources closest to the regions that need them the most. Densely populated regions will generate larger amounts of legitimate traffic, and the data centers placed in those regions will have more bandwidth and CPU resources to meet those needs. Sparsely populated regions will naturally generate less legitimate traffic, so Cloudflare data centers in those regions can be sized appropriately. Since attack traffic is mainly coming from compromised devices, those devices will tend to be distributed in a manner that matches normal traffic flows sending the attack traffic proportionally to datacenters that can handle it. And similarly, within the datacenter, traffic is distributed across multiple machines.&lt;/p&gt;&lt;p&gt;Additionally, for high bandwidth attacks, Cloudflare’s network has another advantage. A large proportion of traffic on the Cloudflare network does not consume bandwidth in a symmetrical manner. For example, an HTTP request to get a webpage from a site behind Cloudflare will be a relatively small incoming packet, but produce a larger amount of outgoing traffic back to the client. This means that the Cloudflare network tends to egress far more legitimate traffic than we receive. However, the network links and bandwidth allocated are symmetrical, meaning there is an abundance of ingress bandwidth available to receive volumetric attack traffic.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;generating-real-time-signatures\&quot;&gt;Generating real-time signatures&lt;/h3&gt;\n      &lt;a href=\&quot;#generating-real-time-signatures\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;By the time you’ve reached an individual server inside a datacenter, the bandwidth of the attack has been distributed enough that none of the upstream links are saturated. That doesn’t mean the attack has been fully stopped yet, since we haven’t dropped the bad packets. To do that, we need to sample traffic, qualify an attack, and create rules to block the bad packets. &lt;/p&gt;&lt;p&gt;Sampling traffic and dropping bad packets is the job of our &lt;a href=\&quot;https://blog.cloudflare.com/l4drop-xdp-ebpf-based-ddos-mitigations/\&quot;&gt;&lt;u&gt;l4drop&lt;/u&gt;&lt;/a&gt; component, which uses &lt;a href=\&quot;https://netdevconf.info/2.1/papers/Gilberto_Bertin_XDP_in_practice.pdf\&quot;&gt;&lt;u&gt;XDP (eXpress Data Path)&lt;/u&gt;&lt;/a&gt; and leverages an extended version of the Berkeley Packet Filter known as &lt;a href=\&quot;https://blog.cloudflare.com/tag/ebpf/\&quot;&gt;&lt;u&gt;eBPF (extended BPF)&lt;/u&gt;&lt;/a&gt;. This enables us to execute custom code in kernel space and process (drop, forward, or modify) each packet directly at the network interface card (NIC) level. This component helps the system drop packets efficiently without consuming excessive CPU resources on the machine. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1NUxGTvKFs5l6G2UCSxvqw/3632f6728f9361123169d9694c807f0b/BLOG-2586_9.png\&quot; alt=\&quot;BLOG-2586 9\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1362\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Cloudflare DDoS protection system overview&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;We use XDP to sample packets to look for suspicious attributes that indicate an attack. The samples include fields such as the source IP, source port, destination IP, destination port, protocol, TCP flags, sequence number, options, packet rate and more. This analysis is conducted by the &lt;i&gt;denial of service daemon (dosd).&lt;/i&gt; &lt;i&gt;Dosd&lt;/i&gt; holds our secret sauce. It has many &lt;i&gt;filters&lt;/i&gt; which instruct it, based on our curated heuristics, when to initiate mitigation. To our customers, these filters are logically grouped by attack vectors and exposed as the &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/managed-rulesets/\&quot;&gt;&lt;u&gt;DDoS Managed Rules&lt;/u&gt;&lt;/a&gt;. Our customers can &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/managed-rulesets/adjust-rules/\&quot;&gt;&lt;u&gt;customize their behavior&lt;/u&gt;&lt;/a&gt; to some extent, as needed.&lt;/p&gt;&lt;p&gt;As it receives samples from XDP, dosd will generate multiple permutations of fingerprints for suspicious traffic patterns. Then, using a data streaming algorithm, dosd will identify the most optimal fingerprints to mitigate the attack. Once an attack is qualified, dosd will push a mitigation rule inline as an eBPF program to surgically drop the attack traffic. &lt;/p&gt;&lt;p&gt;The detection and mitigation of attacks by dosd is done at the server level, at the data center level and at the global level — and it’s all software defined. This makes our network extremely resilient and leads to almost instant mitigation. There are no out-of-path “scrubbing centers” or “scrubbing devices”. Instead, each server runs the full stack of the Cloudflare product suite including the DDoS detection and mitigation component. And it is all done autonomously. Each server also &lt;i&gt;gossips (multicasts)&lt;/i&gt; mitigation instructions within a data center between servers, and globally between data centers. This ensures that whether an attack is localized or globally distributed, dosd will have already installed mitigation rules inline to ensure a robust mitigation.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;strong-defenses-against-strong-attacks\&quot;&gt;Strong defenses against strong attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#strong-defenses-against-strong-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Our software-defined, autonomous DDoS detection and mitigation systems run across our entire network. In this post we focused mainly on our dynamic fingerprinting capabilities, but our arsenal of defense systems is much larger. The &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/tcp-protection/\&quot;&gt;&lt;u&gt;Advanced TCP Protection&lt;/u&gt;&lt;/a&gt; system and &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/dns-protection/\&quot;&gt;&lt;u&gt;Advanced DNS Protection&lt;/u&gt;&lt;/a&gt; system work alongside our dynamic fingerprinting to identify sophisticated and highly randomized TCP-based DDoS attacks and also leverages statistical analysis to thwart complex DNS-based DDoS attacks. Our defenses also incorporate real-time threat intelligence, traffic profiling, and machine learning classification as part of our &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/managed-rulesets/adaptive-protection/\&quot;&gt;&lt;u&gt;Adaptive DDoS Protection&lt;/u&gt;&lt;/a&gt; to mitigate traffic anomalies. &lt;/p&gt;&lt;p&gt;Together, these systems, alongside the full breadth of the Cloudflare Security portfolio, are built atop of the Cloudflare network — one of the largest networks in the world — to ensure our customers are protected from the largest attacks in the world.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-10-02T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-10-24T09:50:20.565Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4oWX173TYNYhwBecZAf7lU/a9bc6be9b7687ba354e9db1f46f0e685/BLOG-2586_1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;64g1G2mvZyb6PjJsisO09T&quot;],&quot;name&quot;:[0,&quot;DDoS&quot;],&quot;slug&quot;:[0,&quot;ddos&quot;]}],[0,{&quot;id&quot;:[0,&quot;5kIxDMJCg3PXQxVINDL0Cw&quot;],&quot;name&quot;:[0,&quot;Attacks&quot;],&quot;slug&quot;:[0,&quot;attacks&quot;]}],[0,{&quot;id&quot;:[0,&quot;3yArjf0gLKZy8ObEDxbNNi&quot;],&quot;name&quot;:[0,&quot;Trends&quot;],&quot;slug&quot;:[0,&quot;trends&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Manish Arora&quot;],&quot;slug&quot;:[0,&quot;manish&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4u7fayYeIfvEDkEviluW6O/62548ae5a3f678a8e8f1ae566dbdb54d/manish.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Shawn Bohrer&quot;],&quot;slug&quot;:[0,&quot;shawn&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5caDpqzavLG1OKlZHXEaIs/9b4f42d3fef571adc37e4b82ae725fb3/shawn.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@bohrers&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Omer Yoachimik&quot;],&quot;slug&quot;:[0,&quot;omer&quot;],&quot;bio&quot;:[0,&quot;Product Manager / Cloudflare&#39;s DDoS Protection Service&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TXRnB1v4ZHGiL3nRlvRTZ/e47fa218da976d21b5074229b33b9589/omer.png&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@OmerYoahimik&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Cody Doucette&quot;],&quot;slug&quot;:[0,&quot;cody-doucette&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6WuOIO745xQocmriRTJFpZ/07d50aba265e49e13f933cc2ee5681f0/cody-doucette.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Alex Forster&quot;],&quot;slug&quot;:[0,&quot;alex-forster&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4pCN3DTLyeVoIeQ2amvqdy/dd9104d78b872da4184d71f64c4cb35c/alex-forster.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@alex_forster&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Nick Wood&quot;],&quot;slug&quot;:[0,&quot;nick-wood&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7qTZDAtaw85IDos0L7YfL/3cd3a86ddaf5d30884dbfb6b5a21d4cf/nick-wood.png&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Over the past couple of weeks, Cloudflare&#39;s DDoS protection systems have automatically and successfully mitigated multiple hyper-volumetric L3/4 DDoS attacks exceeding 3 billion packets per second (Bpps). Our systems also automatically mitigated multiple attacks exceeding 3 terabits per second (Tbps), with the largest ones exceeding 3.65 Tbps. The scale of these attacks is unprecedented.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack - Locale List - (deDE_frFR_esES_ptBR_zhTW_zhCN_jaJP_koKR)&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;English for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;Translated for Locale&quot;],&quot;ptBR&quot;:[0,&quot;Translated for Locale&quot;],&quot;esLA&quot;:[0,&quot;English for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;English for Locale&quot;],&quot;thTH&quot;:[0,&quot;English for Locale&quot;],&quot;trTR&quot;:[0,&quot;English for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;How Cloudflare auto-mitigated a world record 3.8 Tbps DDoS attack&quot;],&quot;description&quot;:[0,&quot;Cloudflare’s DDoS defenses have automatically and successfully detected and mitigated a 3.8 terabit per second DDoS attack — the largest attack on record — as part of a month-long campaign of over a hundred hyper-volumetric L3/4 DDoS attacks.\n&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7pofsKkChZMjVLdvsjg7s8/02b958f5283cb17ae4a3ab17b1dae63a/BLOG-2586_OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;tagInfo&quot;:[0],&quot;authorInfo&quot;:[0],&quot;translatedPosts&quot;:[1,[]]}" ssr client="only" opts="{&quot;name&quot;:&quot;GoogleAnalytics&quot;,&quot;value&quot;:&quot;react&quot;}"></astro-island><script>(()=>{var l=(n,t)=>{let i=async()=>{await(await n())()},e=typeof t.value=="object"?t.value:void 0,s={timeout:e==null?void 0:e.timeout};"requestIdleCallback"in window?window.requestIdleCallback(i,s):setTimeout(i,s.timeout||200)};(self.Astro||(self.Astro={})).idle=l;window.dispatchEvent(new Event("astro:idle"));})();</script><astro-island uid="EYY7a" prefix="r7" component-url="/_astro/Navigation.BG9ngiam.js" component-export="Navigation" renderer-url="/_astro/client.CI64Qvmy.js" props="{&quot;title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;logo&quot;:[0,&quot;//images.ctfassets.net/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png&quot;],&quot;pagesStore&quot;:[0,{&quot;page&quot;:[0,&quot;Post&quot;],&quot;slug&quot;:[0,&quot;how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack&quot;],&quot;translationsAvailable&quot;:[1,[[0,&quot;zh-cn&quot;],[0,&quot;zh-tw&quot;],[0,&quot;fr-fr&quot;],[0,&quot;de-de&quot;],[0,&quot;ja-jp&quot;],[0,&quot;ko-kr&quot;],[0,&quot;pt-br&quot;],[0,&quot;es-es&quot;]]],&quot;navData&quot;:[1,[[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Foe3R8of95cWVnQwe5Toi&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T22:44:28.803Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-10-29T12:38:20.927Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,267],&quot;revision&quot;:[0,72],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;AI&quot;],&quot;name&quot;:[0,&quot;AI&quot;],&quot;slug&quot;:[0,&quot;ai&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4HIPcb68qM0e26fIxyfzwQ&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:21.536Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-10-30T05:03:58.054Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,179],&quot;revision&quot;:[0,60],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Developers&quot;],&quot;name&quot;:[0,&quot;Developers&quot;],&quot;slug&quot;:[0,&quot;developers&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:26.040Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-10-14T05:04:55.442Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,217],&quot;revision&quot;:[0,53],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6QktrXeEFcl4e2dZUTZVGl&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:20.198Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-09T11:02:56.665Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,68],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Product News&quot;],&quot;name&quot;:[0,&quot;Product News&quot;],&quot;slug&quot;:[0,&quot;product-news&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:42:46.231Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-11-04T09:38:14.569Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,191],&quot;revision&quot;:[0,57],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Security&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;16yk8DVbNNifxov5cWvAov&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:56:23.848Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-10-14T05:04:58.023Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,75],&quot;revision&quot;:[0,32],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;name&quot;:[0,&quot;Policy &amp; Legal&quot;],&quot;slug&quot;:[0,&quot;policy&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;J61Eszqn98amrYHq4IhTx&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:43:46.068Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-10-14T05:04:56.395Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,148],&quot;revision&quot;:[0,47],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Zero Trust&quot;],&quot;name&quot;:[0,&quot;Zero Trust&quot;],&quot;slug&quot;:[0,&quot;zero-trust&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;48r7QV00gLMWOIcM1CSDRy&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:54:22.790Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-04-07T23:03:52.422Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,66],&quot;revision&quot;:[0,28],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;name&quot;:[0,&quot;Speed &amp; Reliability&quot;],&quot;slug&quot;:[0,&quot;speed-and-reliability&quot;],&quot;featured&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;4g8tPriKOAUwdUT4jNPebe&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:40.927Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-09-19T22:57:38.748Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,79],&quot;revision&quot;:[0,30],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;name&quot;:[0,&quot;Life at Cloudflare&quot;],&quot;slug&quot;:[0,&quot;life-at-cloudflare&quot;],&quot;featured&quot;:[0,true],&quot;publiclyIndex&quot;:[0,true]}]}],[0,{&quot;metadata&quot;:[0,{&quot;tags&quot;:[1,[]],&quot;concepts&quot;:[1,[]]}],&quot;sys&quot;:[0,{&quot;space&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Space&quot;],&quot;id&quot;:[0,&quot;zkvhlag99gkb&quot;]}]}],&quot;id&quot;:[0,&quot;V86khSc459Yi1AhTlvtY7&quot;],&quot;type&quot;:[0,&quot;Entry&quot;],&quot;createdAt&quot;:[0,&quot;2024-10-09T19:46:53.657Z&quot;],&quot;updatedAt&quot;:[0,&quot;2025-02-04T17:12:59.473Z&quot;],&quot;environment&quot;:[0,{&quot;sys&quot;:[0,{&quot;id&quot;:[0,&quot;master&quot;],&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;Environment&quot;]}]}],&quot;publishedVersion&quot;:[0,57],&quot;revision&quot;:[0,21],&quot;contentType&quot;:[0,{&quot;sys&quot;:[0,{&quot;type&quot;:[0,&quot;Link&quot;],&quot;linkType&quot;:[0,&quot;ContentType&quot;],&quot;id&quot;:[0,&quot;blogTag&quot;]}]}],&quot;locale&quot;:[0,&quot;en-US&quot;]}],&quot;fields&quot;:[0,{&quot;entryTitle&quot;:[0,&quot;Partners&quot;],&quot;name&quot;:[0,&quot;Partners&quot;],&quot;slug&quot;:[0,&quot;partners&quot;],&quot;featured&quot;:[0,true]}]}]]]}],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}]}" ssr client="idle" opts="{&quot;name&quot;:&quot;NavigationComponent&quot;,&quot;value&quot;:true}" await-children><header class="flex flex-row flex-wrap justify-between items-flex-end mw8 center mv3 pl3 pr1"><div class="w-100 flex items-flex-end justify-between justify-start-l"><div class="w-100 tr flex justify-end"><div class="flex justify-between items-center"><span class="dn di-l pr1"><a href="https://dash.cloudflare.com/sign-up" class="f1 blue1 dn di-l b no-underline underline-hover" target="_blank" rel="noreferrer">Get Started Free</a></span><span class="f1 gray4 dn di-l pr1">|</span><span class="dn di-l"><a target="_blank" href="https://www.cloudflare.com/plans/enterprise/contact/" class="f1 gray4 no-underline underline-hover pr1" rel="noreferrer">Contact Sales</a></span><span class="f1 gray4 dn di-l pr1">|</span><div class="relative flex cf-dropdown"><div class="flex items-center" dir="ltr"><button type="button" class="f1 gray4 no-underline language-picker js-language-picker" style="background:transparent;border:none;padding:0"><span class="language-picker__globe-icon"></span><span class="language-picker__caret-icon ph1">▼</span></button></div></div></div></div></div><div class="w-100 w-50-l flex items-end nb5 nb1-l"><a href="/" class="header-logo mr4 dn db-l"><img class="header-logo" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/69RwBidpiEHCDZ9rFVVk7T/092507edbed698420b89658e5a6d5105/CF_logo_stacked_blktype.png" alt="The Cloudflare Blog" width="170" height="57"/></a><h2 class="mt0 mb1 dn di-l"><a href="/" class="fw5 f5 gray3 no-underline"><span class="dn di-l">The Cloudflare Blog</span></a></h2></div><div class="w-100 w-50-l dn db-l"><div class="w-100 tr mkto-sub-message"><p class="f2">Subscribe to receive notifications of new posts:</p></div><div class="w-100 tr"><div class="marketo-form-container"><form id="mktoForm_1653"><div class="top-subscribe-form-container"><div class="top-subscribe-form-field"><input placeholder="Email Address" class="top-subscribe-form-input" name="email" type="email" title="Must be valid email."/></div><button class="top-subscribe-form-button" type="button">Subscribe</button></div></form></div></div></div></header><nav dir="ltr" class="bb b--black-10 db dn-l w-100 ph3 "><div class=" flex justify-between items-center" style="height:44px"><a href="/search/"><img class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a><button type="button" style="background:transparent;border:none"><img src="/images/hamburger.svg" alt="hamburger menu"/></button></div><div class="js-mobile-nav-container dn"><div class="flex flex-column flex-wrap bg-gray9 o-95 absolute ph3 z-1 left-0 right-0 mx-4"><div class="pv3 ph2 tl"><a href="/tag/ai/" class="no-underline gray1 f4 fw7">AI</a></div><div class="pv3 ph2 tl"><a href="/tag/developers/" class="no-underline gray1 f4 fw7">Developers</a></div><div class="pv3 ph2 tl"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f4 fw7">Radar</a></div><div class="pv3 ph2 tl"><a href="/tag/product-news/" class="no-underline gray1 f4 fw7">Product News</a></div><div class="pv3 ph2 tl"><a href="/tag/security/" class="no-underline gray1 f4 fw7">Security</a></div><div class="pv3 ph2 tl"><a href="/tag/policy/" class="no-underline gray1 f4 fw7">Policy &amp; Legal</a></div><div class="pv3 ph2 tl"><a href="/tag/zero-trust/" class="no-underline gray1 f4 fw7">Zero Trust</a></div><div class="pv3 ph2 tl"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f4 fw7">Speed &amp; Reliability</a></div><div class="pv3 ph2 tl"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f4 fw7">Life at Cloudflare</a></div><div class="pv3 ph2 tl"><a href="/tag/partners/" class="no-underline gray1 f4 fw7">Partners</a></div></div></div></nav><nav id="nav" class="w-100 bb-0 bb-l b--black-10 z-1"><div id="desktop-nav-items-container" class="flex flex-wrap justify-between items-center mw8 center mv3 mv0-l"><div data-tag="ai" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/ai/" class="no-underline gray1 f2 fw5 pv3">AI</a></div><div data-tag="developers" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/developers/" class="no-underline gray1 f2 fw5 pv3">Developers</a></div><div data-tag="cloudflare-radar" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/cloudflare-radar/" class="no-underline gray1 f2 fw5 pv3">Radar</a></div><div data-tag="product-news" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/product-news/" class="no-underline gray1 f2 fw5 pv3">Product News</a></div><div data-tag="security" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/security/" class="no-underline gray1 f2 fw5 pv3">Security</a></div><div data-tag="policy" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/policy/" class="no-underline gray1 f2 fw5 pv3">Policy &amp; Legal</a></div><div data-tag="zero-trust" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/zero-trust/" class="no-underline gray1 f2 fw5 pv3">Zero Trust</a></div><div data-tag="speed-and-reliability" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/speed-and-reliability/" class="no-underline gray1 f2 fw5 pv3">Speed &amp; Reliability</a></div><div data-tag="life-at-cloudflare" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/life-at-cloudflare/" class="no-underline gray1 f2 fw5 pv3">Life at Cloudflare</a></div><div data-tag="partners" class="nav-item nav-item-desktop ml3 mr2 dn db-l pv3"><a href="/tag/partners/" class="no-underline gray1 f2 fw5 pv3">Partners</a></div><div class="nav-item ml2 mr3 dn db-l pv3" data-tag="search icon"><a href="/search/"><img id="search-icon" class="h-6 w-6" src="/images/magnifier.svg" alt="magnifier icon"/></a></div></div></nav><!--astro:end--></astro-island><progress class="reading-progress" value="0" max="100" aria-label="Reading progress"></progress><script> async function replaceServerIsland(id, r) { let s = document.querySelector(`script[data-island-id="${id}"]`); if (!s || r.status !== 200 || r.headers.get('content-type')?.split(';')[0].trim() !== 'text/html') return; let html = await r.text(); while (s.previousSibling && s.previousSibling.nodeType !== 8 && s.previousSibling.data !== '[if astro]>server-island-start<![endif]') s.previousSibling.remove(); s.previousSibling?.remove(); s.before(document.createRange().createContextualFragment(html)); s.remove(); } </script><script>(()=>{var e=async t=>{await(await t())()};(self.Astro||(self.Astro={})).load=e;window.dispatchEvent(new Event("astro:load"));})();</script><astro-island uid="wtXYr" prefix="r3" component-url="/_astro/Post.CrIniNkB.js" component-export="Post" renderer-url="/_astro/client.CI64Qvmy.js" props="{&quot;post&quot;:[0,{&quot;id&quot;:[0,&quot;4j6QWqeVFn6qzs0Md0LK7h&quot;],&quot;title&quot;:[0,&quot;How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack&quot;],&quot;slug&quot;:[0,&quot;how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack&quot;],&quot;excerpt&quot;:[0,&quot;Over the past couple of weeks, Cloudflare&#39;s DDoS protection systems have automatically and successfully mitigated multiple hyper-volumetric L3/4 DDoS attacks exceeding 3 billion packets per second (Bpps). Our systems also automatically mitigated multiple attacks exceeding 3 terabits per second (Tbps), with the largest ones exceeding 3.65 Tbps. The scale of these attacks is unprecedented.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Since early September, &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/about/components/#autonomous-edge\&quot;&gt;&lt;u&gt;Cloudflare&amp;#39;s DDoS protection systems&lt;/u&gt;&lt;/a&gt; have been combating a month-long campaign of hyper-volumetric L3/4 DDoS attacks. Cloudflare’s defenses mitigated over one hundred hyper-volumetric L3/4 DDoS attacks throughout the month, with many exceeding 2 billion packets per second (Bpps) and 3 terabits per second (Tbps). The largest attack peaked 3.8 Tbps — the largest ever disclosed publicly by any organization. Detection and mitigation was fully autonomous. The graphs below represent two separate attack events that targeted the same Cloudflare customer and were mitigated autonomously.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7hXUgmEd37kzZrMs0KPXLl/21a4779022bdff91f760dc66759eb955/BLOG-2586_2.png\&quot; alt=\&quot;BLOG-2586 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;922\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;A mitigated 3.8 Terabits per second DDoS attack that lasted 65 seconds&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1uxvtlkdFoH6KU6waXxK3o/d17fe7cf0e33c20e64a47b3ca0e6ca63/BLOG-2586_3.png\&quot; alt=\&quot;BLOG-2586 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1076\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;A mitigated 2.14 billion packet per second DDoS attack that lasted 60 seconds&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;cloudflare-customers-are-protected\&quot;&gt;Cloudflare customers are protected&lt;/h2&gt;\n      &lt;a href=\&quot;#cloudflare-customers-are-protected\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Cloudflare customers using Cloudflare’s HTTP reverse proxy services (e.g. &lt;a href=\&quot;https://developers.cloudflare.com/waf/\&quot;&gt;&lt;u&gt;Cloudflare WAF&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/cache/\&quot;&gt;&lt;u&gt;Cloudflare CDN&lt;/u&gt;&lt;/a&gt;) are automatically protected.&lt;/p&gt;&lt;p&gt;Cloudflare customers using &lt;a href=\&quot;https://developers.cloudflare.com/spectrum/\&quot;&gt;&lt;u&gt;Spectrum&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://developers.cloudflare.com/magic-transit/\&quot;&gt;&lt;u&gt;Magic Transit&lt;/u&gt;&lt;/a&gt; are also automatically protected. Magic Transit customers can further optimize their protection by deploying &lt;a href=\&quot;https://developers.cloudflare.com/magic-firewall/\&quot;&gt;&lt;u&gt;Magic Firewall&lt;/u&gt;&lt;/a&gt; rules to enforce a strict positive and negative security model at the packet layer.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;other-internet-properties-may-not-be-safe\&quot;&gt;Other Internet properties may not be safe&lt;/h2&gt;\n      &lt;a href=\&quot;#other-internet-properties-may-not-be-safe\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The scale and frequency of these attacks are unprecedented. Due to their sheer size and bits/packets per second rates, these attacks have the ability to take down unprotected Internet properties, as well as Internet properties that are protected by on-premise equipment or by cloud providers that just don’t have sufficient network capacity or global coverage to be able to handle these volumes alongside legitimate traffic without impacting performance. &lt;/p&gt;&lt;p&gt;Cloudflare, however, does have the network capacity, global coverage, and intelligent systems needed to absorb and automatically mitigate these monstrous attacks. &lt;/p&gt;&lt;p&gt;In this blog post, we will review the attack campaign and why its attacks are so severe. We will describe the anatomy of a Layer 3/4 DDoS attack, its objectives, and how attacks are generated. We will then proceed to detail how Cloudflare’s systems were able to autonomously detect and mitigate these monstrous attacks without impacting performance for our customers. We will describe the key aspects of our defenses, starting with how our systems generate real-time (dynamic) signatures to match the attack traffic all the way to how we leverage kernel features to drop packets at wire-speed.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;campaign-analysis\&quot;&gt;Campaign analysis&lt;/h2&gt;\n      &lt;a href=\&quot;#campaign-analysis\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We have observed this attack campaign targeting multiple customers in the financial services, Internet, and telecommunication industries, among others. This attack campaign targets bandwidth saturation as well as resource exhaustion of in-line applications and devices.&lt;/p&gt;&lt;p&gt;The attacks predominantly leverage &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/\&quot;&gt;&lt;u&gt;UDP&lt;/u&gt;&lt;/a&gt; on a fixed port, and originated from across the globe with larger shares coming from Vietnam, Russia, Brazil, Spain, and the US. &lt;/p&gt;&lt;p&gt;The high packet rate attacks appear to originate from multiple types of compromised devices, including MikroTik devices, DVRs, and Web servers, orchestrated to work in tandem and flood the target with exceptionally large volumes of traffic. The high bitrate attacks appear to originate from a large number of compromised ASUS home routers, likely exploited using &lt;a href=\&quot;https://censys.com/june-20-improper-authentication-vulnerability-in-asus-routers/\&quot;&gt;&lt;u&gt;a CVE 9.8 (Critical) vulnerability that was recently discovered by Censys&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;div style=\&quot;margin-left:0pt;\&quot; dir=\&quot;ltr\&quot; align=\&quot;left\&quot;&gt;\n    &lt;figure class=\&quot;table\&quot;&gt;\n        &lt;table class=\&quot;ck-table-resized\&quot; style=\&quot;border-collapse:collapse;border-style:none;\&quot;&gt;\n            &lt;colgroup&gt;\n                &lt;col style=\&quot;width:50%;\&quot; width=\&quot;344\&quot;&gt;\n                &lt;col style=\&quot;width:50%;\&quot; width=\&quot;100\&quot;&gt;\n            &lt;/colgroup&gt;\n            &lt;tbody&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Russia&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;12.1%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Vietnam&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;11.6%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;United States&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;9.3%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Spain&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;6.5%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Brazil&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;4.7%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;France&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;4.7%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Romania&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;4.4%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Taiwan&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;3.4%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:19.5pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;United Kingdom&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;3.3%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n                &lt;tr style=\&quot;height:15.75pt;\&quot;&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;Italy&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                    &lt;td style=\&quot;border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;\&quot;&gt;\n                        &lt;p style=\&quot;line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;\&quot; dir=\&quot;ltr\&quot;&gt;&lt;span style=\&quot;background-color:transparent;color:#000000;font-family:Arial,sans-serif;\&quot;&gt;&lt;span style=\&quot;font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;\&quot;&gt;2.8%&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;\n                    &lt;/td&gt;\n                &lt;/tr&gt;\n            &lt;/tbody&gt;\n        &lt;/table&gt;\n    &lt;/figure&gt;\n&lt;/div&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Share of packets observed by source location&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;anatomy-of-ddos-attacks\&quot;&gt;Anatomy of DDoS attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#anatomy-of-ddos-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Before we discuss how Cloudflare automatically detected and mitigated the largest DDoS attacks ever seen, it‘s important to understand the basics of DDoS attacks. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7HLtAHnyjS33iiJAR1B9h9/2e1fc2cab871440fc95fa803989ae156/BLOG-2586_5.png\&quot; alt=\&quot;BLOG-2586 5\&quot; class=\&quot;kg-image\&quot; width=\&quot;1190\&quot; height=\&quot;830\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Simplified diagram of a DDoS attack&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;The goal of a &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/\&quot;&gt;&lt;u&gt;Distributed Denial of Service (DDoS) attack&lt;/u&gt;&lt;/a&gt; is to deny legitimate users access to a service. This is usually done by exhausting resources needed to provide the service. In the context of these recent Layer 3/4 DDoS attacks, that resource is CPU cycles and network bandwidth.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;exhausting-cpu-cycles\&quot;&gt;Exhausting CPU cycles&lt;/h3&gt;\n      &lt;a href=\&quot;#exhausting-cpu-cycles\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Processing a packet consumes CPU cycles. In the case of regular (non-attack) traffic, a &lt;i&gt;legitimate&lt;/i&gt; packet received by a service will cause that service to perform some action, and different actions require different amounts of CPU processing. However, before a packet is even delivered to a service there is per-packet work that needs to be done. Layer 3 packet headers need to be parsed and processed to deliver the packet to the correct machine and interface. Layer 4 packet headers need to be processed and routed to the correct socket (if any). There may be multiple additional processing steps that inspect every packet. Therefore, if an attacker sends at a high enough packet rate, then they can potentially saturate the available CPU resources, denying service to legitimate users.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3aBbNG4Fc7TY6MTugLl3BE/064fb17761aebbce737a5a4518a14235/BLOG-2586_6.png\&quot; alt=\&quot;BLOG-2586 6\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;To defend against high packet rate attacks, you need to be able to inspect and discard the bad packets using as few CPU cycles as possible, leaving enough CPU to process the good packets. You can additionally acquire more, or faster, CPUs to perform the processing — but that can be a very lengthy process that bears high costs. &lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;exhausting-network-bandwidth\&quot;&gt;Exhausting network bandwidth&lt;/h3&gt;\n      &lt;a href=\&quot;#exhausting-network-bandwidth\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Network bandwidth is the total amount of data per time that can be delivered to a server. You can think of bandwidth like a pipe to transport water. The amount of water we can deliver through a drinking straw is less than what we could deliver through a garden hose. If an attacker is able to push more garbage data into the pipe than it can deliver, then both the bad data &lt;i&gt;and&lt;/i&gt; the good data will be discarded upstream, at the entrance to the pipe, and the DDoS is therefore successful.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/OehVItOhGfP9ApllRvDDM/fce73e6f375173a1a53bc22026e0b9b1/BLOG-2586_7.png\&quot; alt=\&quot;BLOG-2586 7\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;675\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;\nDefending against attacks that can saturate network bandwidth can be difficult because there is very little that can be done if you are on the downstream side of the saturated pipe. There are really only a few choices: you can get a bigger pipe, you can potentially find a way to move the good traffic to a new pipe that isn’t saturated, or you can hopefully ask the upstream side of the pipe to stop sending some or all of the data into the pipe.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;generating-ddos-attacks\&quot;&gt;Generating DDoS attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#generating-ddos-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;If we think about what this means from the attackers point of view you realize there are similar constraints. Just as it takes CPU cycles to receive a packet, it also takes CPU cycles to create a packet. If, for example, the cost to send and receive a packet were equal, then the attacker would need an equal amount of CPU power to generate the attack as we would need to defend against it. In most cases this is not true — there is a cost asymmetry, as the attacker is able to generate packets using fewer CPU cycles than it takes to receive those packets. However, it is worth noting that generating attacks is not free and can require a large amount of CPU power.&lt;/p&gt;&lt;p&gt;Saturating network bandwidth can be even more difficult for an attacker. Here the attacker needs to be able to output more bandwidth than the target service has allocated. They actually need to be able to exceed the capacity of the receiving service. This is so difficult that the most common way to achieve a network bandwidth attack is to use a reflection/amplification attack method, for example a &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/\&quot;&gt;&lt;u&gt;DNS Amplification attack&lt;/u&gt;&lt;/a&gt;. These attacks allow the attacker to send a small packet to an intermediate service, and the intermediate service will send a large packet to the victim.&lt;/p&gt;&lt;p&gt;In both scenarios, the attacker needs to acquire or gain access to many devices to generate the attack. These devices can be acquired in a number of different ways. They may be server class machines from cloud providers or hosting services, or they can be compromised devices like DVRs, routers, and webcams that have been infected with the attacker’s malware. These machines together form the botnet.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;how-cloudflare-defends-against-large-attacks\&quot;&gt;How Cloudflare defends against large attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#how-cloudflare-defends-against-large-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Now that we understand the fundamentals of how DDoS attacks work, we can explain how Cloudflare can defend against these attacks.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;spreading-the-attack-surface-using-global-anycast\&quot;&gt;Spreading the attack surface using global anycast&lt;/h3&gt;\n      &lt;a href=\&quot;#spreading-the-attack-surface-using-global-anycast\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The first not-so-secret ingredient is that Cloudflare’s network is built on &lt;a href=\&quot;https://www.cloudflare.com/learning/cdn/glossary/anycast-network/\&quot;&gt;&lt;u&gt;anycast&lt;/u&gt;&lt;/a&gt;. In brief, anycast allows a single IP address to be advertised by multiple machines around the world. A packet sent to that IP address will be served by the closest machine. This means when an attacker uses their distributed botnet to launch an attack, the attack will be received in a distributed manner across the Cloudflare network. An infected DVR in Dallas, Texas will send packets to a Cloudflare server in Dallas. An infected webcam in London will send packets to a Cloudflare server in London.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/48tW6A6ACUT4Fd9h3l70F4/c6bcea8f037fc853477d0987c939e007/BLOG-2586_8.png\&quot; alt=\&quot;BLOG-2586 8\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1880\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Anycast vs. Unicast networks&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;Our anycast network additionally allows Cloudflare to allocate compute and bandwidth resources closest to the regions that need them the most. Densely populated regions will generate larger amounts of legitimate traffic, and the data centers placed in those regions will have more bandwidth and CPU resources to meet those needs. Sparsely populated regions will naturally generate less legitimate traffic, so Cloudflare data centers in those regions can be sized appropriately. Since attack traffic is mainly coming from compromised devices, those devices will tend to be distributed in a manner that matches normal traffic flows sending the attack traffic proportionally to datacenters that can handle it. And similarly, within the datacenter, traffic is distributed across multiple machines.&lt;/p&gt;&lt;p&gt;Additionally, for high bandwidth attacks, Cloudflare’s network has another advantage. A large proportion of traffic on the Cloudflare network does not consume bandwidth in a symmetrical manner. For example, an HTTP request to get a webpage from a site behind Cloudflare will be a relatively small incoming packet, but produce a larger amount of outgoing traffic back to the client. This means that the Cloudflare network tends to egress far more legitimate traffic than we receive. However, the network links and bandwidth allocated are symmetrical, meaning there is an abundance of ingress bandwidth available to receive volumetric attack traffic.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;generating-real-time-signatures\&quot;&gt;Generating real-time signatures&lt;/h3&gt;\n      &lt;a href=\&quot;#generating-real-time-signatures\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;By the time you’ve reached an individual server inside a datacenter, the bandwidth of the attack has been distributed enough that none of the upstream links are saturated. That doesn’t mean the attack has been fully stopped yet, since we haven’t dropped the bad packets. To do that, we need to sample traffic, qualify an attack, and create rules to block the bad packets. &lt;/p&gt;&lt;p&gt;Sampling traffic and dropping bad packets is the job of our &lt;a href=\&quot;https://blog.cloudflare.com/l4drop-xdp-ebpf-based-ddos-mitigations/\&quot;&gt;&lt;u&gt;l4drop&lt;/u&gt;&lt;/a&gt; component, which uses &lt;a href=\&quot;https://netdevconf.info/2.1/papers/Gilberto_Bertin_XDP_in_practice.pdf\&quot;&gt;&lt;u&gt;XDP (eXpress Data Path)&lt;/u&gt;&lt;/a&gt; and leverages an extended version of the Berkeley Packet Filter known as &lt;a href=\&quot;https://blog.cloudflare.com/tag/ebpf/\&quot;&gt;&lt;u&gt;eBPF (extended BPF)&lt;/u&gt;&lt;/a&gt;. This enables us to execute custom code in kernel space and process (drop, forward, or modify) each packet directly at the network interface card (NIC) level. This component helps the system drop packets efficiently without consuming excessive CPU resources on the machine. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1NUxGTvKFs5l6G2UCSxvqw/3632f6728f9361123169d9694c807f0b/BLOG-2586_9.png\&quot; alt=\&quot;BLOG-2586 9\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1362\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;&lt;i&gt;Cloudflare DDoS protection system overview&lt;/i&gt;&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;We use XDP to sample packets to look for suspicious attributes that indicate an attack. The samples include fields such as the source IP, source port, destination IP, destination port, protocol, TCP flags, sequence number, options, packet rate and more. This analysis is conducted by the &lt;i&gt;denial of service daemon (dosd).&lt;/i&gt; &lt;i&gt;Dosd&lt;/i&gt; holds our secret sauce. It has many &lt;i&gt;filters&lt;/i&gt; which instruct it, based on our curated heuristics, when to initiate mitigation. To our customers, these filters are logically grouped by attack vectors and exposed as the &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/managed-rulesets/\&quot;&gt;&lt;u&gt;DDoS Managed Rules&lt;/u&gt;&lt;/a&gt;. Our customers can &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/managed-rulesets/adjust-rules/\&quot;&gt;&lt;u&gt;customize their behavior&lt;/u&gt;&lt;/a&gt; to some extent, as needed.&lt;/p&gt;&lt;p&gt;As it receives samples from XDP, dosd will generate multiple permutations of fingerprints for suspicious traffic patterns. Then, using a data streaming algorithm, dosd will identify the most optimal fingerprints to mitigate the attack. Once an attack is qualified, dosd will push a mitigation rule inline as an eBPF program to surgically drop the attack traffic. &lt;/p&gt;&lt;p&gt;The detection and mitigation of attacks by dosd is done at the server level, at the data center level and at the global level — and it’s all software defined. This makes our network extremely resilient and leads to almost instant mitigation. There are no out-of-path “scrubbing centers” or “scrubbing devices”. Instead, each server runs the full stack of the Cloudflare product suite including the DDoS detection and mitigation component. And it is all done autonomously. Each server also &lt;i&gt;gossips (multicasts)&lt;/i&gt; mitigation instructions within a data center between servers, and globally between data centers. This ensures that whether an attack is localized or globally distributed, dosd will have already installed mitigation rules inline to ensure a robust mitigation.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;strong-defenses-against-strong-attacks\&quot;&gt;Strong defenses against strong attacks&lt;/h2&gt;\n      &lt;a href=\&quot;#strong-defenses-against-strong-attacks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Our software-defined, autonomous DDoS detection and mitigation systems run across our entire network. In this post we focused mainly on our dynamic fingerprinting capabilities, but our arsenal of defense systems is much larger. The &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/tcp-protection/\&quot;&gt;&lt;u&gt;Advanced TCP Protection&lt;/u&gt;&lt;/a&gt; system and &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/dns-protection/\&quot;&gt;&lt;u&gt;Advanced DNS Protection&lt;/u&gt;&lt;/a&gt; system work alongside our dynamic fingerprinting to identify sophisticated and highly randomized TCP-based DDoS attacks and also leverages statistical analysis to thwart complex DNS-based DDoS attacks. Our defenses also incorporate real-time threat intelligence, traffic profiling, and machine learning classification as part of our &lt;a href=\&quot;https://developers.cloudflare.com/ddos-protection/managed-rulesets/adaptive-protection/\&quot;&gt;&lt;u&gt;Adaptive DDoS Protection&lt;/u&gt;&lt;/a&gt; to mitigate traffic anomalies. &lt;/p&gt;&lt;p&gt;Together, these systems, alongside the full breadth of the Cloudflare Security portfolio, are built atop of the Cloudflare network — one of the largest networks in the world — to ensure our customers are protected from the largest attacks in the world.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2024-10-02T14:00+01:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-10-24T09:50:20.565Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4oWX173TYNYhwBecZAf7lU/a9bc6be9b7687ba354e9db1f46f0e685/BLOG-2586_1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;64g1G2mvZyb6PjJsisO09T&quot;],&quot;name&quot;:[0,&quot;DDoS&quot;],&quot;slug&quot;:[0,&quot;ddos&quot;]}],[0,{&quot;id&quot;:[0,&quot;5kIxDMJCg3PXQxVINDL0Cw&quot;],&quot;name&quot;:[0,&quot;Attacks&quot;],&quot;slug&quot;:[0,&quot;attacks&quot;]}],[0,{&quot;id&quot;:[0,&quot;3yArjf0gLKZy8ObEDxbNNi&quot;],&quot;name&quot;:[0,&quot;Trends&quot;],&quot;slug&quot;:[0,&quot;trends&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Manish Arora&quot;],&quot;slug&quot;:[0,&quot;manish&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4u7fayYeIfvEDkEviluW6O/62548ae5a3f678a8e8f1ae566dbdb54d/manish.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Shawn Bohrer&quot;],&quot;slug&quot;:[0,&quot;shawn&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5caDpqzavLG1OKlZHXEaIs/9b4f42d3fef571adc37e4b82ae725fb3/shawn.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@bohrers&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Omer Yoachimik&quot;],&quot;slug&quot;:[0,&quot;omer&quot;],&quot;bio&quot;:[0,&quot;Product Manager / Cloudflare&#39;s DDoS Protection Service&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TXRnB1v4ZHGiL3nRlvRTZ/e47fa218da976d21b5074229b33b9589/omer.png&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@OmerYoahimik&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Cody Doucette&quot;],&quot;slug&quot;:[0,&quot;cody-doucette&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6WuOIO745xQocmriRTJFpZ/07d50aba265e49e13f933cc2ee5681f0/cody-doucette.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Alex Forster&quot;],&quot;slug&quot;:[0,&quot;alex-forster&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4pCN3DTLyeVoIeQ2amvqdy/dd9104d78b872da4184d71f64c4cb35c/alex-forster.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@alex_forster&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Nick Wood&quot;],&quot;slug&quot;:[0,&quot;nick-wood&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7qTZDAtaw85IDos0L7YfL/3cd3a86ddaf5d30884dbfb6b5a21d4cf/nick-wood.png&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Over the past couple of weeks, Cloudflare&#39;s DDoS protection systems have automatically and successfully mitigated multiple hyper-volumetric L3/4 DDoS attacks exceeding 3 billion packets per second (Bpps). Our systems also automatically mitigated multiple attacks exceeding 3 terabits per second (Tbps), with the largest ones exceeding 3.65 Tbps. The scale of these attacks is unprecedented.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack - Locale List - (deDE_frFR_esES_ptBR_zhTW_zhCN_jaJP_koKR)&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;Translated for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;Translated for Locale&quot;],&quot;frFR&quot;:[0,&quot;Translated for Locale&quot;],&quot;deDE&quot;:[0,&quot;Translated for Locale&quot;],&quot;itIT&quot;:[0,&quot;English for Locale&quot;],&quot;jaJP&quot;:[0,&quot;Translated for Locale&quot;],&quot;koKR&quot;:[0,&quot;Translated for Locale&quot;],&quot;ptBR&quot;:[0,&quot;Translated for Locale&quot;],&quot;esLA&quot;:[0,&quot;English for Locale&quot;],&quot;esES&quot;:[0,&quot;Translated for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;English for Locale&quot;],&quot;thTH&quot;:[0,&quot;English for Locale&quot;],&quot;trTR&quot;:[0,&quot;English for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;How Cloudflare auto-mitigated a world record 3.8 Tbps DDoS attack&quot;],&quot;description&quot;:[0,&quot;Cloudflare’s DDoS defenses have automatically and successfully detected and mitigated a 3.8 terabit per second DDoS attack — the largest attack on record — as part of a month-long campaign of over a hundred hyper-volumetric L3/4 DDoS attacks.\n&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7pofsKkChZMjVLdvsjg7s8/02b958f5283cb17ae4a3ab17b1dae63a/BLOG-2586_OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],&quot;initialReadingTime&quot;:[0,&quot;9&quot;],&quot;relatedPosts&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3nRyPdIVogbDGSeUZgRY41&quot;],&quot;title&quot;:[0,&quot;How Workers VPC Services connects to your regional private networks from anywhere in the world&quot;],&quot;slug&quot;:[0,&quot;workers-vpc-open-beta&quot;],&quot;excerpt&quot;:[0,&quot;Workers VPC Services enter open beta today. We look under the hood to see how Workers VPC connects your globally-deployed Workers to your regional private networks by using Cloudflare&#39;s global network, while abstracting cross-cloud networking complexity.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;In April, we shared our vision for a &lt;a href=\&quot;https://blog.cloudflare.com/workers-virtual-private-cloud/\&quot;&gt;&lt;u&gt;global virtual private cloud on Cloudflare&lt;/u&gt;&lt;/a&gt;, a way to unlock your applications from regionally constrained clouds and on-premise networks, enabling you to build truly cross-cloud applications.&lt;/p&gt;&lt;p&gt;Today, we’re announcing the first milestone of our Workers VPC initiative: VPC Services. VPC Services allow you to connect to your APIs, containers, virtual machines, serverless functions, databases and other services in regional private networks via &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/\&quot;&gt;&lt;u&gt;Cloudflare Tunnels&lt;/u&gt;&lt;/a&gt; from your &lt;a href=\&quot;https://workers.cloudflare.com/\&quot;&gt;&lt;u&gt;Workers&lt;/u&gt;&lt;/a&gt; running anywhere in the world. &lt;/p&gt;&lt;p&gt;Once you set up a Tunnel in your desired network, you can register each service that you want to expose to Workers by configuring its host or IP address. Then, you can access the VPC Service as you would any other &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/bindings/service-bindings/\&quot;&gt;&lt;u&gt;Workers service binding&lt;/u&gt;&lt;/a&gt; — Cloudflare’s network will automatically route to the VPC Service over Cloudflare’s network, regardless of where your Worker is executing:&lt;/p&gt;\n            &lt;pre class=\&quot;language-JavaScript\&quot;&gt;&lt;code class=\&quot;language-JavaScript\&quot;&gt;export default {\n  async fetch(request, env, ctx) {\n    // Perform application logic in Workers here\t\n\n    // Call an external API running in a ECS in AWS when needed using the binding\n    const response = await env.AWS_VPC_ECS_API.fetch(&amp;quot;http://internal-host.com&amp;quot;);\n\n    // Additional application logic in Workers\n    return new Response();\n  },\n};&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Workers VPC is now available to everyone using Workers, at no additional cost during the beta, as is Cloudflare Tunnels. &lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/workers/vpc/services\&quot;&gt;&lt;u&gt;Try it out now.&lt;/u&gt;&lt;/a&gt; And read on to learn more about how it works under the hood.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;connecting-the-networks-you-trust-securely\&quot;&gt;Connecting the networks you trust, securely&lt;/h2&gt;\n      &lt;a href=\&quot;#connecting-the-networks-you-trust-securely\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Your applications span multiple networks, whether they are on-premise or in external clouds. But it’s been difficult to connect from Workers to your APIs and databases locked behind private networks. &lt;/p&gt;&lt;p&gt;We have &lt;a href=\&quot;https://blog.cloudflare.com/workers-virtual-private-cloud/\&quot;&gt;&lt;u&gt;previously described&lt;/u&gt;&lt;/a&gt; how traditional virtual private clouds and networks entrench you into traditional clouds. While they provide you with workload isolation and security, traditional virtual private clouds make it difficult to build across clouds, access your own applications, and choose the right technology for your stack.&lt;/p&gt;&lt;p&gt;A significant part of the cloud lock-in is the inherent complexity of building secure, distributed workloads. VPC peering requires you to configure routing tables, security groups and network access-control lists, since it relies on networking across clouds to ensure connectivity. In many organizations, this means weeks of discussions and many teams involved to get approvals. This lock-in is also reflected in the solutions invented to wrangle this complexity: Each cloud provider has their own bespoke version of a “Private Link” to facilitate cross-network connectivity, further restricting you to that cloud and the vendors that have integrated with it.&lt;/p&gt;&lt;p&gt;With Workers VPC, we’re simplifying that dramatically. You set up your Cloudflare Tunnel once, with the necessary permissions to access your private network. Then, you can configure Workers VPC Services, with the tunnel and hostname (or IP address and port) of the service you want to expose to Workers. Any request made to that VPC Service will use this configuration to route to the given service within the network.&lt;/p&gt;\n            &lt;pre class=\&quot;language-JSON\&quot;&gt;&lt;code class=\&quot;language-JSON\&quot;&gt;{\n  &amp;quot;type&amp;quot;: &amp;quot;http&amp;quot;,\n  &amp;quot;name&amp;quot;: &amp;quot;vpc-service-name&amp;quot;,\n  &amp;quot;http_port&amp;quot;: 80,\n  &amp;quot;https_port&amp;quot;: 443,\n  &amp;quot;host&amp;quot;: {\n    &amp;quot;hostname&amp;quot;: &amp;quot;internally-resolvable-hostname.com&amp;quot;,\n    &amp;quot;resolver_network&amp;quot;: {\n      &amp;quot;tunnel_id&amp;quot;: &amp;quot;0191dce4-9ab4-7fce-b660-8e5dec5172da&amp;quot;\n    }\n  }\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;This ensures that, once represented as a Workers VPC Service, a service in your private network is secured in the same way other Cloudflare bindings are, using the Workers binding model. Let’s take a look at a simple VPC Service binding example:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;{\n  &amp;quot;name&amp;quot;: &amp;quot;WORKER-NAME&amp;quot;,\n  &amp;quot;main&amp;quot;: &amp;quot;./src/index.js&amp;quot;,\n  &amp;quot;vpc_services&amp;quot;: [\n    {\n      &amp;quot;binding&amp;quot;: &amp;quot;AWS_VPC2_ECS_API&amp;quot;,\n      &amp;quot;service_id&amp;quot;: &amp;quot;5634563546&amp;quot;\n    }\n  ]\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;Like other Workers bindings, when you deploy a Worker project that tries to connect to a VPC Service, the access permissions are verified at deploy time to ensure that the Worker has access to the service in question. And once deployed, the Worker can use the VPC Service binding to make requests to that VPC Service — and only that service within the network. &lt;/p&gt;&lt;p&gt;That’s significant: Instead of exposing the entire network to the Worker, only the specific VPC Service can be accessed by the Worker. This access is verified at deploy time to provide a more explicit and transparent service access control than traditional networks and access-control lists do.&lt;/p&gt;&lt;p&gt;This is a key factor in the design of Workers bindings: de facto security with simpler management and making Workers immune to Server-Side Request Forgery (SSRF) attacks. &lt;a href=\&quot;https://blog.cloudflare.com/workers-environment-live-object-bindings/#security\&quot;&gt;&lt;u&gt;We’ve gone deep on the binding security model in the past&lt;/u&gt;&lt;/a&gt;, and it becomes that much more critical when accessing your private networks. &lt;/p&gt;&lt;p&gt;Notably, the binding model is also important when considering what Workers are: scripts running on Cloudflare’s global network. They are not, in contrast to traditional clouds, individual machines with IP addresses, and do not exist within networks. Bindings provide secure access to other resources within your Cloudflare account – and the same applies to Workers VPC Services.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;a-peek-under-the-hood\&quot;&gt;A peek under the hood&lt;/h2&gt;\n      &lt;a href=\&quot;#a-peek-under-the-hood\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;So how do VPC Services and their bindings route network requests from Workers anywhere on Cloudflare’s global network to regional networks using tunnels? Let’s look at the lifecycle of a sample HTTP Request made from a VPC Service’s dedicated &lt;b&gt;fetch()&lt;/b&gt; request represented here:&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4iUTiZjmbm2ujppLugfxJo/4db92fdf8549c239f52d8636e2589baf/image4.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1225\&quot; height=\&quot;740\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;It all starts in the Worker code, where the &lt;b&gt;.fetch() &lt;/b&gt;function of the desired VPC Service is called with a standard JavaScript &lt;a href=\&quot;https://developer.mozilla.org/en-US/docs/Web/API/Request\&quot;&gt;&lt;u&gt;Request&lt;/u&gt;&lt;/a&gt; (as represented with Step 1). The Workers runtime will use a &lt;a href=\&quot;https://capnproto.org/\&quot;&gt;&lt;u&gt;Cap’n Proto&lt;/u&gt;&lt;/a&gt; remote-procedure-call to send the original HTTP request alongside additional context, as it does for many other Workers bindings. &lt;/p&gt;&lt;p&gt;The Binding Worker of the VPC Service System receives the HTTP request along with the binding context, in this case, the Service ID of the VPC Service being invoked. The Binding Worker will proxy this information to the Iris Service within an HTTP CONNECT connection, a standard pattern across Cloudflare’s bindings to place connection logic to Cloudflare’s edge services within Worker code rather than the Workers runtime itself (Step 2). &lt;/p&gt;&lt;p&gt;The Iris Service is the main service for Workers VPC. Its responsibility is to accept requests for a VPC Service and route them to the network in which your VPC Service is located. It does this by integrating with &lt;a href=\&quot;https://blog.cloudflare.com/extending-local-traffic-management-load-balancing-to-layer-4-with-spectrum/#how-we-enabled-spectrum-to-support-private-networks\&quot;&gt;&lt;u&gt;Apollo&lt;/u&gt;&lt;/a&gt;, an internal service of &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/?cf_target_id=2026081E85C775AF31266A26CE7F3D4D\&quot;&gt;&lt;u&gt;Cloudflare One&lt;/u&gt;&lt;/a&gt;. Apollo provides a unified interface that abstracts away the complexity of securely connecting to networks and tunnels, &lt;a href=\&quot;https://blog.cloudflare.com/from-ip-packets-to-http-the-many-faces-of-our-oxy-framework/\&quot;&gt;&lt;u&gt;across various layers of networking&lt;/u&gt;&lt;/a&gt;. &lt;/p&gt;&lt;p&gt;To integrate with Apollo, Iris must complete two tasks. First, Iris will parse the VPC Service ID from the metadata and fetch the information of the tunnel associated with it from our configuration store. This includes the tunnel ID and type from the configuration store (Step 3), which is the information that Iris needs to send the original requests to the right tunnel.&lt;/p&gt;&lt;p&gt;Second, Iris will create the UDP datagrams containing DNS questions for the A and AAAA records of the VPC Service’s hostname. These datagrams will be sent first, via Apollo. Once DNS resolution is completed, the original request is sent along, with the resolved IP address and port (Step 4). That means that steps 4 through 7 happen in sequence twice for the first request: once for DNS resolution and a second time for the original HTTP Request. Subsequent requests benefit from Iris’ caching of DNS resolution information, minimizing request latency.&lt;/p&gt;&lt;p&gt;In Step 5, Apollo receives the metadata of the Cloudflare Tunnel that needs to be accessed, along with the DNS resolution UDP datagrams or the HTTP Request TCP packets. Using the tunnel ID, it determines which datacenter is connected to the Cloudflare Tunnel. This datacenter is in a region close to the Cloudflare Tunnel, and as such, Apollo will route the DNS resolution messages and the Original Request to the Tunnel Connector Service running in that datacenter (Step 5).&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6eXnv33qvTvGRRNGqS9ywj/99e57beeaa32de0724c6c9f396ab3b17/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1408\&quot; height=\&quot;736\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The Tunnel Connector Service is responsible for providing access to the Cloudflare Tunnel to the rest of Cloudflare’s network. It will relay the DNS resolution questions, and subsequently the original request to the tunnel over the QUIC protocol (Step 6).&lt;/p&gt;&lt;p&gt;Finally, the Cloudflare Tunnel will send the DNS resolution questions to the DNS resolver of the network it belongs to. It will then send the original HTTP Request from its own IP address to the destination IP and port (Step 7). The results of the request are then relayed all the way back to the original Worker, from the datacenter closest to the tunnel all the way to the original Cloudflare datacenter executing the Worker request.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;what-vpc-service-allows-you-to-build\&quot;&gt;What VPC Service allows you to build&lt;/h2&gt;\n      &lt;a href=\&quot;#what-vpc-service-allows-you-to-build\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;This unlocks a whole new tranche of applications you can build on Cloudflare. For years, Workers have excelled at the edge, but they&amp;#39;ve largely been kept &amp;quot;outside&amp;quot; your core infrastructure. They could only call public endpoints, limiting their ability to interact with the most critical parts of your stack—like a private accounts API or an internal inventory database. Now, with VPC Services, Workers can securely access those private APIs, databases, and services, fundamentally changing what&amp;#39;s possible.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/DDDzgVtHtK92DZ4LwKhLI/904fc30fcab4797fd6ee263f09b85ab1/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1150\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;This immediately enables true cross-cloud applications that span Cloudflare Workers and any other cloud like AWS, GCP or Azure. We’ve seen many customers adopt this pattern over the course of our private beta, establishing private connectivity between their external clouds and Cloudflare Workers. We’ve even done so ourselves, connecting our Workers to Kubernetes services in our core datacenters to power the control plane APIs for many of our services. Now, you can build the same powerful, distributed architectures, using Workers for global scale while keeping stateful backends in the network you already trust.&lt;/p&gt;&lt;p&gt;It also means you can connect to your on-premise networks from Workers, allowing you to modernize legacy applications with the performance and infinite scale of Workers. More interesting still are some emerging use cases for developer workflows. We’ve seen developers run &lt;a href=\&quot;https://developers.cloudflare.com/cloudflare-one/networks/connectors/cloudflare-tunnel/\&quot;&gt;&lt;code&gt;&lt;u&gt;cloudflared&lt;/u&gt;&lt;/code&gt;&lt;/a&gt; on their laptops to connect a deployed Worker back to their local machine for real-time debugging. The full flexibility of Cloudflare Tunnels is now a programmable primitive accessible directly from your Worker, opening up a world of possibilities.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;the-path-ahead-of-us\&quot;&gt;The path ahead of us&lt;/h2&gt;\n      &lt;a href=\&quot;#the-path-ahead-of-us\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;VPC Services is the first milestone within the larger Workers VPC initiative, but we’re just getting started. Our goal is to make connecting to any service and any network, anywhere in the world, a seamless part of the Workers experience. Here’s what we’re working on next:&lt;/p&gt;&lt;p&gt;&lt;b&gt;Deeper network integration&lt;/b&gt;. Starting with Cloudflare Tunnels was a deliberate choice. It&amp;#39;s a highly available, flexible, and familiar solution, making it the perfect foundation to build upon. To provide more options for enterprise networking, we&amp;#39;re going to be adding support for standard IPsec tunnels, Cloudflare Network Interconnect (CNI), and AWS Transit Gateway, giving you and your teams more choices and potential optimizations. Crucially, these connections will also become truly bidirectional, allowing your private services to initiate connections back to Cloudflare resources such as pushing events to Queues or fetching from R2.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Expanded protocol and service support. &lt;/b&gt;The next step beyond HTTP is enabling access to TCP services. This will first be achieved by integrating with Hyperdrive. We&amp;#39;re evolving the previous Hyperdrive support for private databases to be simplified with VPC Services configuration, avoiding the need to add Cloudflare Access and manage security tokens. This creates a more native experience, complete with Hyperdrive&amp;#39;s powerful connection pooling. Following this, we will add broader support for raw TCP connections, unlocking direct connectivity to services like Redis caches and message queues from &lt;a href=\&quot;https://developers.cloudflare.com/workers/runtime-apis/tcp-sockets/\&quot;&gt;&lt;code&gt;&lt;u&gt;Workers ‘connect()’&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;&lt;b&gt;Ecosystem compatibility. &lt;/b&gt;We want to make connecting to a private service feel as natural as connecting to a public one. To do so, we will be providing a unique autogenerated hostname for each Workers VPC Service, similar to &lt;a href=\&quot;https://developers.cloudflare.com/hyperdrive/get-started/#write-a-worker\&quot;&gt;&lt;u&gt;Hyperdrive’s connection strings&lt;/u&gt;&lt;/a&gt;. This will make it easier to use Workers VPC with existing libraries and object–relational mapping libraries that may require a hostname (e.g., in a global ‘&lt;code&gt;fetch()&lt;/code&gt;’ call or a MongoDB connection string). Workers VPC Service hostname will automatically resolve and route to the correct VPC Service, just as the ‘&lt;code&gt;fetch()&lt;/code&gt;’ command does.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;get-started-with-workers-vpc\&quot;&gt;Get started with Workers VPC&lt;/h2&gt;\n      &lt;a href=\&quot;#get-started-with-workers-vpc\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We’re excited to release Workers VPC Services into open beta today. We’ve spent months building out and testing our first milestone for Workers to private network access. And we’ve refined it further based on feedback from both internal teams and customers during the closed beta. &lt;/p&gt;&lt;p&gt;&lt;b&gt;Now, we’re looking forward to enabling everyone to build cross-cloud apps on Workers with Workers VPC, available for free during the open beta.&lt;/b&gt; With Workers VPC, you can bring your apps on private networks to region Earth, closer to your users and available to Workers across the globe.&lt;/p&gt;&lt;p&gt;&lt;a href=\&quot;https://dash.cloudflare.com/?to=/:account/workers/vpc/services\&quot;&gt;&lt;b&gt;&lt;u&gt;Get started with Workers VPC Services for free now.&lt;/u&gt;&lt;/b&gt;&lt;/a&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-11-05T14:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-11-05T14:00:09.863Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/66ZjYyTM1PSduy2rLVPVn4/ffd606d4a2098d803211bbfe96a7dd72/image1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;6hbkItfupogJP3aRDAq6v8&quot;],&quot;name&quot;:[0,&quot;Cloudflare Workers&quot;],&quot;slug&quot;:[0,&quot;workers&quot;]}],[0,{&quot;id&quot;:[0,&quot;6igRMoqTmLynPz6ChgITLr&quot;],&quot;name&quot;:[0,&quot;Workers VPC&quot;],&quot;slug&quot;:[0,&quot;workers-vpc&quot;]}],[0,{&quot;id&quot;:[0,&quot;2kFnzwwExTv3DVtV0CTReO&quot;],&quot;name&quot;:[0,&quot;Cloudflare Tunnel&quot;],&quot;slug&quot;:[0,&quot;cloudflare-tunnel&quot;]}],[0,{&quot;id&quot;:[0,&quot;1U6ifhBwTuaJ2w4pjNOzNT&quot;],&quot;name&quot;:[0,&quot;Network&quot;],&quot;slug&quot;:[0,&quot;network&quot;]}],[0,{&quot;id&quot;:[0,&quot;7nOCkblcU47qyT7n0ZioiP&quot;],&quot;name&quot;:[0,&quot;Hybrid Cloud&quot;],&quot;slug&quot;:[0,&quot;hybrid-cloud&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}],[0,{&quot;id&quot;:[0,&quot;4tHWoGuSxQqvJIbgkgQYKn&quot;],&quot;name&quot;:[0,&quot;VPC&quot;],&quot;slug&quot;:[0,&quot;vpc&quot;]}],[0,{&quot;id&quot;:[0,&quot;4zmIAufUsJHpuTrVs0sOTw&quot;],&quot;name&quot;:[0,&quot;Private Network&quot;],&quot;slug&quot;:[0,&quot;private-network&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Thomas Gauvin&quot;],&quot;slug&quot;:[0,&quot;thomas-gauvin&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2niktUqyQO5YzVIBCwrBGl/9474ec9faff3b27f7ec9013a066b9b54/Thomas_Gauvin.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0,&quot;https://thomasgauvin.com/&quot;],&quot;twitter&quot;:[0,&quot;thomasgauvin&quot;],&quot;facebook&quot;:[0,&quot;https://www.linkedin.com/in/thomas-gauvin/&quot;],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Matt Alonso&quot;],&quot;slug&quot;:[0,&quot;matt-alonso&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/28IQWzENpxkBKoy5vIJWKu/7007f9f38e561e6e090b6da32295d0de/IMG_1945.png&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Eric Falcão&quot;],&quot;slug&quot;:[0,&quot;eric-falcao&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3JyuBDNArl9D7VaLtNvN5/f41c56567d54589f0499452cbdfb9c06/Eric_Falca%C3%8C_o.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Workers VPC Services enter open beta today. We look under the hood to see how Workers VPC connects your globally-deployed Workers to your regional private networks by using Cloudflare&#39;s global network, while abstracting cross-cloud networking complexity.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/workers-vpc-open-beta&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;How Workers VPC Services connects to your regional private networks from anywhere in the world&quot;],&quot;description&quot;:[0,&quot;Workers VPC Services enter open beta today. We look under the hood to see how Workers VPC connects your globally-deployed Workers to your regional private networks by using Cloudflare&#39;s global network, while abstracting cross-cloud networking complexity.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5Up0uMXtAJt2BwlyT2mMsQ/34a83c4a46b768cb86b92df15ee43c00/OG_Share_2024_-_2025-11-04T104929.283.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;404c64k0KinGRYZkfe0xum&quot;],&quot;title&quot;:[0,&quot;Fresh insights from old data: corroborating reports of Turkmenistan IP unblocking and firewall testing&quot;],&quot;slug&quot;:[0,&quot;fresh-insights-from-old-data-corroborating-reports-of-turkmenistan-ip&quot;],&quot;excerpt&quot;:[0,&quot;Cloudflare used historical data to investigate reports of potential new firewall tests in Turkmenistan. Shifts in TCP resets/timeouts across ASNs corroborate large-scale network control system changes.\n&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;Here at Cloudflare, we frequently use and write about data in the present. But sometimes understanding the present begins with digging into the past.  &lt;/p&gt;&lt;p&gt;We recently learned of a 2024 &lt;a href=\&quot;https://turkmen.news/internet-amnistiya-v-turkmenistane-razblokirovany-3-milliarda-ip-adresov-hostingi-i-cdn/\&quot;&gt;&lt;u&gt;turkmen.news article&lt;/u&gt;&lt;/a&gt; (available in Russian) that reports &lt;a href=\&quot;https://radar.cloudflare.com/tm\&quot;&gt;&lt;u&gt;Turkmenistan&lt;/u&gt;&lt;/a&gt; experienced “an unprecedented easing in blocking,” causing over 3 billion previously-blocked IP addresses to become reachable. The same article reports that one of the reasons for unblocking IP addresses was that Turkmenistan may have been testing a new firewall. (The Turkmen government’s tight control over the country’s Internet access &lt;a href=\&quot;https://www.bbc.com/news/world-asia-16095369\&quot;&gt;&lt;u&gt;is well-documented&lt;/u&gt;&lt;/a&gt;.) &lt;/p&gt;&lt;p&gt;Indeed, &lt;a href=\&quot;https://radar.cloudflare.com/\&quot;&gt;&lt;u&gt;Cloudflare Radar&lt;/u&gt;&lt;/a&gt; shows a surge of requests coming from Turkmenistan around the same time, as we’ll show below. But we had an additional question: Does the firewall activity show up on Radar, as well? Two years ago, we launched the &lt;a href=\&quot;https://blog.cloudflare.com/tcp-resets-timeouts/\&quot;&gt;&lt;u&gt;dashboard on Radar&lt;/u&gt;&lt;/a&gt; to give a window into the TCP connections to Cloudflare that close due to resets and timeouts. These stand out because they are considered ungraceful mechanisms to close TCP connections, according to the TCP specification. &lt;/p&gt;&lt;p&gt;In this blog post, we go back in time to share what Cloudflare saw in connection resets and timeouts. We must remind our readers that, as passive observers, there are &lt;a href=\&quot;https://blog.cloudflare.com/connection-tampering/#limitations-of-our-data\&quot;&gt;&lt;u&gt;limitations on what we can glean from the data&lt;/u&gt;&lt;/a&gt;. For example, our data can’t reveal attribution. Even so, the ability to observe our environment &lt;a href=\&quot;https://blog.cloudflare.com/tricky-internet-measurement/\&quot;&gt;&lt;u&gt;can be insightful&lt;/u&gt;&lt;/a&gt;. In a recent example, our visibility into resets and timeouts helped corroborate reports of large-scale &lt;a href=\&quot;https://blog.cloudflare.com/russian-internet-users-are-unable-to-access-the-open-internet/\&quot;&gt;&lt;u&gt;blocking and traffic tampering by Russia&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;turkmenistan-requests-where-there-were-none-before\&quot;&gt;Turkmenistan requests where there were none before&lt;/h3&gt;\n      &lt;a href=\&quot;#turkmenistan-requests-where-there-were-none-before\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;Let’s look first at the number of requests, since those should increase if IP addresses are unblocked. In mid-June 2024 Cloudflare started receiving a noticeable increase in HTTP requests, consistent with &lt;a href=\&quot;https://turkmen.news/internet-amnistiya-v-turkmenistane-razblokirovany-3-milliarda-ip-adresov-hostingi-i-cdn/\&quot;&gt;&lt;u&gt;reports&lt;/u&gt;&lt;/a&gt; of Turkmenistan unblocking IPs.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3Kqaxxjv9g52RVMWg92AYu/e57468cf523702cadd634c34775be033/BLOG_3069_2.png\&quot; alt=\&quot;BLOG 3069 2\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;1125\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/traffic/tm?dateStart=2024-06-01&amp;dateEnd=2024-06-30\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;overall-tcp-resets-and-timeouts\&quot;&gt;Overall TCP resets and timeouts&lt;/h3&gt;\n      &lt;a href=\&quot;#overall-tcp-resets-and-timeouts\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;The Transmission Control Protocol (TCP) is a lower-layer mechanism used to create a connection between clients and servers, and also carries &lt;a href=\&quot;https://radar.cloudflare.com/adoption-and-usage#http1x-vs-http2-vs-http3\&quot;&gt;&lt;u&gt;70% of HTTP traffic&lt;/u&gt;&lt;/a&gt; to Cloudflare. A TCP connection works &lt;a href=\&quot;https://blog.cloudflare.com/connection-tampering/#explaining-tampering-with-telephone-calls\&quot;&gt;&lt;u&gt;much like a telephone call&lt;/u&gt;&lt;/a&gt; between humans, who follow graceful conventions to end a call—and who are acutely aware when conventions are broken if a call ends abruptly.  &lt;/p&gt;&lt;p&gt;TCP also defines conventions to end the connection gracefully, and we developed &lt;a href=\&quot;https://blog.cloudflare.com/tcp-resets-timeouts/\&quot;&gt;&lt;u&gt;mechanisms to detect&lt;/u&gt;&lt;/a&gt; when they don’t. An ungraceful end is triggered by a reset instruction or a timeout. Some are due to benign artifacts of software design or human user behaviours. However, sometimes they are exploited by &lt;a href=\&quot;https://blog.cloudflare.com/connection-tampering\&quot;&gt;&lt;u&gt;third parties to close connections&lt;/u&gt;&lt;/a&gt; in everything from school and enterprise firewalls or software, to zero-rating on mobile plans, to nation-state filtering.&lt;/p&gt;&lt;p&gt;When we look at connections from Turkmenistan, we see that on June 13, 2024, the combined proportion of the four coloured regions increases; each coloured region represents ungraceful ends at a distinct stage of the connection lifetime. In addition to the combined increase, the relative proportions between stages (or colours) changes as well.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1hNDpdNS9lDPKg3jFHigiL/ff3de33af7974c5d32ba421cbbc3c42e/BLOG_3069_3.png\&quot; alt=\&quot;BLOG 3069 3\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;876\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2023-10-01&amp;dateEnd=2023-11-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Further changes appeared in the weeks that followed. Among them are an increase in Post-PSH (orange) anomalies starting around July 4; a reduction in Post-ACK (light blue) anomalies around July 13; and an increase in anomalies later in connections (green) starting July 22.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6IavKOkF7tB02MtNqJPqqD/f08c78f65894e751b7c9fce9820dee85/BLOG_3069_4.png\&quot; alt=\&quot;BLOG 3069 4\&quot; class=\&quot;kg-image\&quot; width=\&quot;1604\&quot; height=\&quot;802\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2024-07-01&amp;dateEnd=2024-07-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;The shifts above &lt;i&gt;could&lt;/i&gt; be explained by a large firewall system. It’s important to keep in mind that data in each of the connection stages (captured by the four coloured regions in the graphs) can be explained by browser implementations or user actions. However, the scale of the data would need a great number of browsers or users doing the same thing to show up. Similarly, individual changes in behaviour would be lost unless they occur in large numbers at the same time.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;digging-down-to-individual-networks\&quot;&gt;Digging down to individual networks&lt;/h3&gt;\n      &lt;a href=\&quot;#digging-down-to-individual-networks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We’ve learned that it can be helpful to look at the data for individual networks to reveal common patterns between different networks in different regions &lt;a href=\&quot;https://blog.cloudflare.com/tcp-resets-timeouts/#zero-rating-in-mobile-networks\&quot;&gt;&lt;u&gt;operated by single entities&lt;/u&gt;&lt;/a&gt;. &lt;/p&gt;&lt;p&gt;Looking at individual networks within Turkmenistan, trends and timelines appear more pronounced. July 22 in particular sees greater proportions of anomalies associated with the &lt;a href=\&quot;https://www.cloudflare.com/learning/ssl/what-is-sni/\&quot;&gt;&lt;u&gt;Server Name Indication&lt;/u&gt;&lt;/a&gt;, or domain name, rather than the IP address (dark blue), although the connection stage where the anomalies appear varies by individual network.&lt;/p&gt;&lt;p&gt;The general Turkmenistan trends are largely mirrored in connections from &lt;a href=\&quot;https://radar.cloudflare.com/as20661\&quot;&gt;&lt;u&gt;AS20661 (TurkmenTelecom)&lt;/u&gt;&lt;/a&gt;, indicating that this &lt;a href=\&quot;https://www.cloudflare.com/learning/network-layer/what-is-an-autonomous-system/\&quot;&gt;&lt;u&gt;autonomous system&lt;/u&gt;&lt;/a&gt; (AS) accounts for &lt;a href=\&quot;https://radar.cloudflare.com/tm#autonomous-systems\&quot;&gt;&lt;u&gt;a large proportion of Turkmenistan’s traffic&lt;/u&gt;&lt;/a&gt; to Cloudflare’s network. There is a notable reduction in Post-ACK (light blue) anomalies starting around July 26.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5ukNOB1CYUAPW2s7ofdqMK/7d1dca367374db90627413e2c40a6ee3/BLOG_3069_5.png\&quot; alt=\&quot;BLOG 3069 5\&quot; class=\&quot;kg-image\&quot; width=\&quot;1608\&quot; height=\&quot;804\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2023-10-01&amp;dateEnd=2023-11-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;A different picture emerges from &lt;a href=\&quot;https://radar.cloudflare.com/as51495\&quot;&gt;&lt;u&gt;AS51495 (Ashgabat City Telephone Network)&lt;/u&gt;&lt;/a&gt;. Post-ACK anomalies almost completely disappear on July 12, corresponding with an increase in anomalies during the Post-PSH stage. An increase of anomalies in the Later (green) connection stage on July 22 is apparent for this AS as well.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7btBYWx2VVVg0MH10yY9ot/17e87bf94f97b1cd43139e432f189770/BLOG_3069_6.png\&quot; alt=\&quot;BLOG 3069 6\&quot; class=\&quot;kg-image\&quot; width=\&quot;1602\&quot; height=\&quot;806\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2023-10-01&amp;dateEnd=2023-11-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;Finally, for &lt;a href=\&quot;https://radar.cloudflare.com/as59974\&quot;&gt;&lt;u&gt;AS59974 (Altyn Asyr)&lt;/u&gt;&lt;/a&gt;, you can see below that there is a clear spike in Post-ACK anomalies starting July 22. This is the stage of the connection where a firewall could have seen the SNI, and chooses to drop the packets immediately, so they never reach Cloudflare’s servers.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4pxUHjzkRwnbmaSsgkhiKd/b56fbc84e2fdcd8b889b6e8b3a68dc40/BLOG_3069_7.png\&quot; alt=\&quot;BLOG 3069 7\&quot; class=\&quot;kg-image\&quot; width=\&quot;1602\&quot; height=\&quot;804\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2023-10-01&amp;dateEnd=2023-11-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;timeouts-and-resets-in-context-never-isolation\&quot;&gt;Timeouts and resets in context, never isolation&lt;/h3&gt;\n      &lt;a href=\&quot;#timeouts-and-resets-in-context-never-isolation\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We’ve previously discussed &lt;a href=\&quot;https://blog.cloudflare.com/tcp-resets-timeouts/\&quot;&gt;&lt;u&gt;how to use the resets and timeouts&lt;/u&gt;&lt;/a&gt; data because, while useful, it can also be misinterpreted. Radar’s data on resets and timeouts is unique among operators, but in isolation it’s incomplete and subject to human bias. &lt;/p&gt;&lt;p&gt;Take the figure above for AS59974 where Post-ACK (light blue) anomalies markedly increased on July 22. The Radar view is proportional, meaning that the increase in proportion could be explained by greater numbers of anomalies – but could also be explained, for example, by a smaller number of valid requests. Indeed, looking at the HTTP request levels for the same AS, there was a similarly pronounced drop starting on the same day, as shown below. &lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2PAYPpcFeInis6zo4lWrSx/f28a1f84fbe5b1c21659911b11331c30/BLOG_3069_8.png\&quot; alt=\&quot;BLOG 3069 8\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;916\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2023-10-01&amp;dateEnd=2023-11-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;If we look at the same two graphs before July 22, however, rates of reset and timeout anomalies do not appear to mirror the very large shifts up and down in HTTP requests.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;looking-ahead-can-also-mean-looking-behind\&quot;&gt;Looking ahead can also mean looking behind&lt;/h3&gt;\n      &lt;a href=\&quot;#looking-ahead-can-also-mean-looking-behind\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;These charts from Radar above offer a way to analyze news events from a different angle, by looking at requests and TCP connection resets and timeouts. Does this data tell us definitively that new firewalls were being tested in Turkmenistan? No. But the trends in the data are consistent with what we could expect to see if that were the case.&lt;/p&gt;&lt;p&gt;If thinking about ways to use the resets and timeouts data going forward, we’d encourage also looking at the data in retrospect—or even further past to improve context.&lt;/p&gt;&lt;p&gt;A natural question might be, for example, “If Turkmenistan stopped blocking IPs in mid-2024, what did the data say beforehand?” The figure below captures October and November 2023. (The red-shaded region contains missing data due to the &lt;a href=\&quot;https://blog.cloudflare.com/post-mortem-on-cloudflare-control-plane-and-analytics-outage\&quot;&gt;&lt;u&gt;Nov. 2 Cloudflare control plane and metrics outage&lt;/u&gt;&lt;/a&gt;.) Signals about the Internet in Turkmenistan were evolving well before the &lt;a href=\&quot;https://turkmen.news/internet-amnistiya-v-turkmenistane-razblokirovany-3-milliarda-ip-adresov-hostingi-i-cdn/\&quot;&gt;&lt;u&gt;news article&lt;/u&gt;&lt;/a&gt; that prompted us to look.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2W4MfieKNV24PmvynAAIfO/af42a2328059eb15fba0619372973887/BLOG_3069_9.png\&quot; alt=\&quot;BLOG 3069 9\&quot; class=\&quot;kg-image\&quot; width=\&quot;1600\&quot; height=\&quot;878\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Source: &lt;/sup&gt;&lt;a href=\&quot;https://radar.cloudflare.com/security/network-layer/tm?dateStart=2023-10-01&amp;dateEnd=2023-11-30#tcp-resets-and-timeouts\&quot;&gt;&lt;sup&gt;Cloudflare Radar&lt;/sup&gt;&lt;/a&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;whats-next\&quot;&gt;What’s next?&lt;/h3&gt;\n      &lt;a href=\&quot;#whats-next\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;To learn more, see our guide about &lt;a href=\&quot;https://blog.cloudflare.com/tcp-resets-timeouts/\&quot;&gt;&lt;u&gt;how to use the resets and timeouts data available on Radar&lt;/u&gt;&lt;/a&gt;, as well as the technical details about our &lt;a href=\&quot;https://blog.cloudflare.com/connection-tampering/\&quot;&gt;&lt;u&gt;third-party tampering measurement &lt;/u&gt;&lt;/a&gt;and some perspectives by a former &lt;a href=\&quot;https://blog.cloudflare.com/experience-of-data-at-scale/\&quot;&gt;&lt;u&gt;intern who helped drive&lt;/u&gt;&lt;/a&gt; the study. &lt;/p&gt;&lt;p&gt;We’re proud to offer a unique view of TCP connection anomalies on Radar. It’s a testament to the long-lived benefits that emerge when approaching &lt;a href=\&quot;https://blog.cloudflare.com/tricky-internet-measurement/\&quot;&gt;&lt;u&gt;Internet measurement as a science&lt;/u&gt;&lt;/a&gt;. In keeping with the open spirit of science, we’ve also shared how we&lt;a href=\&quot;https://blog.cloudflare.com/tricky-internet-measurement/\&quot;&gt;&lt;u&gt; detect and log resets and timeouts&lt;/u&gt;&lt;/a&gt; so that others can reproduce the observability on their servers, whether by hobbyists or other large operators.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-11-03T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-11-03T14:00:09.681Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/67Ip8cliOI46I1ecsQpRV0/8828284d41175d52f6bfa3f9f6990c2f/BLOG_3069_1.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;5kZtWqjqa7aOUoZr8NFGwI&quot;],&quot;name&quot;:[0,&quot;Radar&quot;],&quot;slug&quot;:[0,&quot;cloudflare-radar&quot;]}],[0,{&quot;id&quot;:[0,&quot;1x7tpPmKIUCt19EDgM1Tsl&quot;],&quot;name&quot;:[0,&quot;Research&quot;],&quot;slug&quot;:[0,&quot;research&quot;]}],[0,{&quot;id&quot;:[0,&quot;sBnaK06GQyzaHg5OdsV90&quot;],&quot;name&quot;:[0,&quot;Internet Shutdown&quot;],&quot;slug&quot;:[0,&quot;internet-shutdown&quot;]}],[0,{&quot;id&quot;:[0,&quot;4laB8bhYCVRUFrB5hgoCsL&quot;],&quot;name&quot;:[0,&quot;Internet Trends&quot;],&quot;slug&quot;:[0,&quot;internet-trends&quot;]}],[0,{&quot;id&quot;:[0,&quot;3yArjf0gLKZy8ObEDxbNNi&quot;],&quot;name&quot;:[0,&quot;Trends&quot;],&quot;slug&quot;:[0,&quot;trends&quot;]}],[0,{&quot;id&quot;:[0,&quot;4nA5kKyA1tOqFyjHMque21&quot;],&quot;name&quot;:[0,&quot;Consumer Services&quot;],&quot;slug&quot;:[0,&quot;consumer-services&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Luke Valenta&quot;],&quot;slug&quot;:[0,&quot;luke&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2FfvsynZPyK2w2lJSIXdqr/f8758aa6638121491d233932a076770e/luke.jpg&quot;],&quot;location&quot;:[0,&quot;Austin, TX&quot;],&quot;website&quot;:[0,&quot;https://lukevalenta.com/&quot;],&quot;twitter&quot;:[0,&quot;@lukevalenta&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Marwan Fayed&quot;],&quot;slug&quot;:[0,&quot;marwan&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/IXphrXdPbBBtMHdRMzIrB/340102a31143f4743a74c87ec0e0c11e/marwan.jpg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@marwanfayed&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;Cloudflare used historical data to investigate reports of potential new firewall tests in Turkmenistan. Shifts in TCP resets/timeouts across ASNs corroborate large-scale network control system changes.\n&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/fresh-insights-from-old-data-corroborating-reports-of-turkmenistan-ip&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Fresh insights from old data: corroborating reports of Turkmenistan IP unblocking and firewall testing&quot;],&quot;description&quot;:[0,&quot;Cloudflare used historical data to investigate reports of potential new firewall tests in Turkmenistan. Shifts in TCP resets/timeouts across ASNs corroborate large-scale network control system changes.\n&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/JevNDZqmzUArt4VNIKzf6/65edffac18196f87cc619e05c258d2bf/Fresh_insights_from_old_data-_corroborating_reports_of_Turkmenistan_IP_unblocking_and_firewall_testing-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;sucWiZHlaWXeLFddHtkk1&quot;],&quot;title&quot;:[0,&quot;Go and enhance your calm: demolishing an HTTP/2 interop problem&quot;],&quot;slug&quot;:[0,&quot;go-and-enhance-your-calm&quot;],&quot;excerpt&quot;:[0,&quot;HTTP/2 implementations often respond to suspected attacks by closing the connection with an ENHANCE_YOUR_CALM error code. Learn how a common pattern of using Go&#39;s HTTP/2 client can lead to unintended errors and the solution to avoiding them.&quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;In September 2025, a thread popped up in our internal engineering chat room asking, &amp;quot;Which part of our stack would be responsible for sending &lt;code&gt;ErrCode=ENHANCE_YOUR_CALM&lt;/code&gt; to an HTTP/2 client?&amp;quot; Two internal microservices were experiencing a critical error preventing their communication and the team needed a timely answer.&lt;/p&gt;&lt;p&gt;In this blog post, we describe the background to well-known HTTP/2 attacks that trigger Cloudflare defences, which close connections. We then document an easy-to-make mistake using Go&amp;#39;s standard library that can cause clients to send PING flood attacks and how you can avoid it.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2OL6xA151F9JNR4S0wE0DG/f6ae4b0a261da5d189d82ccfa401104e/image1.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;469\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;http-2-is-powerful-but-it-can-be-easy-to-misuse\&quot;&gt;HTTP/2 is powerful – but it can be easy to misuse&lt;/h3&gt;\n      &lt;a href=\&quot;#http-2-is-powerful-but-it-can-be-easy-to-misuse\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;&lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9113\&quot;&gt;&lt;u&gt;HTTP/2&lt;/u&gt;&lt;/a&gt; defines a binary wire format for encoding &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9110.html\&quot;&gt;&lt;u&gt;HTTP semantics&lt;/u&gt;&lt;/a&gt;. Request and response messages are encoded as a series of HEADERS and DATA frames, each associated with a logical stream, sent over a TCP connection using TLS. There are also control frames that relate to the management of streams or the connection as a whole. For example, SETTINGS frames advertise properties of an endpoint, WINDOW_UPDATE frames provide flow control credit to a peer so that it can send data, RST_STREAM can be used to cancel or reject a request or response, while GOAWAY can be used to signal graceful or immediate connection closure.&lt;/p&gt;&lt;p&gt;HTTP/2 provides many powerful features that have legitimate uses. However, with great power comes responsibility and opportunity for accidental or intentional misuse. The specification details a number of &lt;a href=\&quot;https://datatracker.ietf.org/doc/html/rfc9113#section-10.5\&quot;&gt;&lt;u&gt;denial-of-service considerations&lt;/u&gt;&lt;/a&gt;. Implementations are advised to harden themselves: &amp;quot;An endpoint that doesn&amp;#39;t monitor use of these features exposes itself to a risk of denial of service. Implementations SHOULD track the use of these features and set limits on their use.&amp;quot;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/71AXf477FP8u9znjdqXIh9/d6d22049a3f5f5488b8b7e9ac7f832a9/image3.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1200\&quot; height=\&quot;361\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;Cloudflare implements many different HTTP/2 defenses, developed over years in order to protect our systems and our customers. Some notable examples include mitigations added in 2019 to address &amp;quot;&lt;a href=\&quot;https://blog.cloudflare.com/on-the-recent-http-2-dos-attacks/\&quot;&gt;&lt;u&gt;Netflix vulnerabilities&lt;/u&gt;&lt;/a&gt;&amp;quot; and in 2023 to mitigate &lt;a href=\&quot;https://blog.cloudflare.com/technical-breakdown-http2-rapid-reset-ddos-attack/\&quot;&gt;&lt;u&gt;Rapid Reset&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://blog.cloudflare.com/madeyoureset-an-http-2-vulnerability-thwarted-by-rapid-reset-mitigations/\&quot;&gt;&lt;u&gt;similar&lt;/u&gt;&lt;/a&gt; style attacks.&lt;/p&gt;&lt;p&gt;When Cloudflare detects that HTTP/2 client behaviour is likely malicious, we close the connection using the GOAWAY frame and include the error code &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9113#ENHANCE_YOUR_CALM\&quot;&gt;&lt;code&gt;&lt;u&gt;ENHANCE_YOUR_CALM&lt;/u&gt;&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;One of the well-known and common attacks is &lt;a href=\&quot;https://www.cve.org/CVERecord?id=CVE-2019-9512\&quot;&gt;&lt;u&gt;CVE-2019-9512&lt;/u&gt;&lt;/a&gt;, aka PING flood: &amp;quot;The attacker sends continual pings to an HTTP/2 peer, causing the peer to build an internal queue of responses. Depending on how efficiently this data is queued, this can consume excess CPU, memory, or both.&amp;quot; Sending a &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9113#section-6.7\&quot;&gt;&lt;u&gt;PING frame&lt;/u&gt;&lt;/a&gt; causes the peer to respond with a PING acknowledgement (indicated by an ACK flag). This allows for checking the liveness of the HTTP connection, along with measuring the layer 7 round-trip time – both useful things. The requirement to acknowledge a PING, however, provides the potential attack vector since it generates work for the peer.&lt;/p&gt;&lt;p&gt;A client that PINGs the Cloudflare edge too frequently will trigger our &lt;a href=\&quot;https://www.cve.org/CVERecord?id=CVE-2019-9512\&quot;&gt;&lt;u&gt;CVE-2019-9512&lt;/u&gt;&lt;/a&gt; mitigations, causing us to close the connection. Shortly after we &lt;a href=\&quot;https://blog.cloudflare.com/road-to-grpc/\&quot;&gt;&lt;u&gt;launched support for gRPC&lt;/u&gt;&lt;/a&gt; in 2020, we encountered interoperability issues with some gRPC clients that sent many PINGs as part of a &lt;a href=\&quot;https://grpc.io/blog/grpc-go-perf-improvements/#bdp-estimation-and-dynamic-flow-control-window\&quot;&gt;&lt;u&gt;performance optimization for window tuning&lt;/u&gt;&lt;/a&gt;. We also discovered that the Rust Hyper crate had a feature called Adaptive Window that emulated the design and triggered a similar &lt;a href=\&quot;https://github.com/hyperium/hyper/issues/2526\&quot;&gt;&lt;u&gt;problem&lt;/u&gt;&lt;/a&gt; until Hyper made a &lt;a href=\&quot;https://github.com/hyperium/hyper/pull/2550\&quot;&gt;&lt;u&gt;fix&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;solving-a-microservice-miscommunication-mystery\&quot;&gt;Solving a microservice miscommunication mystery&lt;/h3&gt;\n      &lt;a href=\&quot;#solving-a-microservice-miscommunication-mystery\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;When that thread popped up asking which part of our stack was responsible for sending the &lt;code&gt;ENHANCE_YOUR_CALM&lt;/code&gt; error code, it was regarding a client communicating over HTTP/2 between two internal microservices.&lt;/p&gt;&lt;p&gt;We suspected that this was an HTTP/2 mitigation issue and confirmed it was a PING flood mitigation in our logs. But taking a step back, you may wonder why two internal microservices are communicating over the Cloudflare edge at all, and therefore hitting our mitigations. In this case, communicating over the edge provides us with several advantages:&lt;/p&gt;&lt;ol&gt;&lt;li&gt;&lt;p&gt;We get to dogfood our edge infrastructure and discover issues like this!&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;We can use Cloudflare Access for authentication. This allows our microservices to be accessed securely by both other services (using service tokens) and engineers (which is invaluable for debugging).&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;Internal services that are written with Cloudflare Workers can easily communicate with services that are accessible at the edge.&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6v9oBdn5spdqw1BjDW1bS3/a9b36ef9252d580a79c978eb366f7a7a/image2.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1344\&quot; height=\&quot;1028\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;The question remained: Why was this client behaving this way? We traded some ideas as we attempted to get to the bottom of the issue.&lt;/p&gt;&lt;p&gt;The client had a configuration that would indicate that it didn&amp;#39;t need to PING very frequently:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Go\&quot;&gt;&lt;code class=\&quot;language-Go\&quot;&gt;t2.PingTimeout = 2 * time.Second\nt2.ReadIdleTimeout = 5 * time.Second&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;However, in situations like this it is generally a good idea to establish ground truth about what is really happening &amp;quot;on the wire.&amp;quot; For instance, grabbing a packet capture that can be dissected and explored in Wireshark can provide unequivocal evidence of precisely what was sent over the network. The next best option is detailed/trace logging at the sender or receiver, although sometimes logging can be misleading, so caveat emptor.&lt;/p&gt;&lt;p&gt;In our particular case, it was simpler to use logging with &lt;code&gt;GODEBUG=http2debug=2&lt;/code&gt;. We built a simplified minimal reproduction of the client that triggered the error, helping to eliminate other potential variables. We did some group log analysis, combined with diving into some of the Go standard library code to understand what it was really doing. Issac Asimov is commonly credited with the quote &amp;quot;The most exciting phrase to hear in science, the one that heralds new discoveries, is not &amp;#39;Eureka!&amp;#39; but &amp;#39;That&amp;#39;s funny...&amp;#39;&amp;quot; and sure enough, within the hour someone declared–\n\n&lt;i&gt;the funny part I see is this:&lt;/i&gt;&lt;/p&gt;\n            &lt;pre class=\&quot;language-Go\&quot;&gt;&lt;code class=\&quot;language-Go\&quot;&gt;2025/09/02 17:33:18 http2: Framer 0x14000624540: wrote RST_STREAM stream=9 len=4 ErrCode=CANCEL\n2025/09/02 17:33:18 http2: Framer 0x14000624540: wrote PING len=8 ping=&amp;quot;j\\xe7\\xd6R\\xdaw\\xf8+&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;i&gt;every ping seems to be preceded by a RST_STREAM&lt;/i&gt;&lt;/p&gt;&lt;p&gt;Observant readers will recall the earlier mention of Rapid Reset. However, our logs clearly indicated ENHANCE_YOUR_CALM being triggered due to the PING flood. A bit of searching landed us on this &lt;a href=\&quot;https://groups.google.com/g/grpc-io/c/sWYYQJXHCAQ/m/SWFHxw9IAgAJ\&quot;&gt;&lt;u&gt;mailing list thread&lt;/u&gt;&lt;/a&gt; and the comment &amp;quot;Sending a PING frame along with an RST_STREAM allows a client to distinguish between an unresponsive server and a slow response.&amp;quot; That seemed quite relevant. We also found &lt;a href=\&quot;https://go-review.googlesource.com/c/net/+/632995\&quot;&gt;&lt;u&gt;a change that was committed&lt;/u&gt;&lt;/a&gt; related to this topic. This partly answered why there were so many PINGs, but it also raised a new question: Why so many stream resets?\n\nSo we went back to the logs and built up a little more context about the interaction:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Go\&quot;&gt;&lt;code class=\&quot;language-Go\&quot;&gt;2025/09/02 17:33:18 http2: Transport received DATA flags=END_STREAM stream=47 len=0 data=&amp;quot;&amp;quot;\n2025/09/02 17:33:18 http2: Framer 0x14000624540: wrote RST_STREAM stream=47 len=4 ErrCode=CANCEL\n2025/09/02 17:33:18 http2: Framer 0x14000624540: wrote PING len=8 ping=&amp;quot;\\x97W\\x02\\xfa&amp;gt;\\xa8\\xabi&amp;quot;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;The interesting thing here is that the server had sent a DATA frame with the END_STREAM flag set. Per the HTTP/2 stream &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9113#section-5.1\&quot;&gt;&lt;u&gt;state machine&lt;/u&gt;&lt;/a&gt;, the stream should have transitioned to &lt;b&gt;closed&lt;/b&gt; when a frame with END_STREAM was processed. The client doesn&amp;#39;t need to do anything in this state – sending a RST_STREAM is entirely unnecessary.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/R0Bbw1SFYwcyb280RdwjY/578628489c97f67a5ac877a55f4f3e3b/image6.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1421\&quot; height=\&quot;1331\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;A little more digging and noodling and an engineer proclaimed:\n\n&lt;i&gt;I noticed that the reset+ping only happens when you call r&lt;/i&gt;&lt;code&gt;&lt;i&gt;esp.Body.Close()&lt;/i&gt;&lt;/code&gt;&lt;/p&gt;&lt;p&gt;&lt;i&gt;I believe Go&amp;#39;s HTTP library doesn&amp;#39;t actually read the response body automatically, but keeps the stream open for you to use until you call r&lt;/i&gt;&lt;code&gt;&lt;i&gt;esp.Body.Close()&lt;/i&gt;&lt;/code&gt;&lt;i&gt;, which you can do at any point you like.&lt;/i&gt;&lt;/p&gt;&lt;p&gt;The hilarious thing in our example was that there wasn&amp;#39;t actually any HTTP body to read. From the earlier example: &lt;code&gt;received DATA flags=END_STREAM stream=47 len=0 data=&amp;quot;&amp;quot;&lt;/code&gt;.&lt;/p&gt;&lt;p&gt;Science and engineering are at times weird and counterintuitive. We decided to tweak our client to read the (absent) body via &lt;code&gt;io.Copy(io.Discard, resp.Body)&lt;/code&gt; before closing it. &lt;/p&gt;&lt;p&gt;Sure enough, this immediately stopped the client sending both a useless RST_STREAM and, by association, a PING frame. &lt;/p&gt;&lt;p&gt;Mystery solved?&lt;/p&gt;&lt;p&gt;To prove we had fixed the root cause, the production client was updated with a similar fix. A few hours later, all the ENHANCE_YOUR_CALM closures were eliminated.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;reading-bodies-in-go-can-be-unintuitive\&quot;&gt;Reading bodies in Go can be unintuitive&lt;/h3&gt;\n      &lt;a href=\&quot;#reading-bodies-in-go-can-be-unintuitive\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;It’s worth noting that in some situations, ensuring the response body is always read can sometimes be unintuitive in Go. For example, at first glance it appears that the response body will always be read in the following example:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;resp, err := http.DefaultClient.Do(req)\nif err != nil {\n\treturn err\n}\ndefer resp.Body.Close()\n\nif err := json.NewDecoder(resp.Body).Decode(&amp;amp;respBody); err != nil {\n\treturn err\n}&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;However, &lt;code&gt;json.Decoder&lt;/code&gt; stops reading as soon as it finds a complete JSON document or errors. If the response body contains multiple JSON documents or invalid JSON, then the entire response body may still not be read.&lt;/p&gt;&lt;p&gt;Therefore, in our clients, we’ve started replacing &lt;code&gt;defer response.Body.Close()&lt;/code&gt; with the following pattern to ensure that response bodies are always fully read:&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;resp, err := http.DefaultClient.Do(req)\nif err != nil {\n\treturn err\n}\ndefer func() {\n\tio.Copy(io.Discard, resp.Body)\n\tresp.Body.Close()\n}()\n\nif err := json.NewDecoder(resp.Body).Decode(&amp;amp;respBody); err != nil {\n\treturn err\n}&lt;/pre&gt;&lt;/code&gt;\n            \n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h2 id=\&quot;actions-to-take-if-you-encounter-enhance_your_calm\&quot;&gt;Actions to take if you encounter ENHANCE_YOUR_CALM&lt;/h2&gt;\n      &lt;a href=\&quot;#actions-to-take-if-you-encounter-enhance_your_calm\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;HTTP/2 is a protocol with several features. Many implementations have implemented hardening to protect themselves from misuse of features, which can trigger a connection to be closed. The recommended error code for closing connections in such conditions is ENHANCE_YOUR_CALM. There are numerous HTTP/2 implementations and APIs, which may drive the use of HTTP/2 features in unexpected ways that could appear like attacks.&lt;/p&gt;&lt;p&gt;If you have an HTTP/2 client that encounters closures with ENHANCE_YOUR_CALM, we recommend that you try to establish ground truth with packet captures (including TLS decryption keys via mechanisms like &lt;a href=\&quot;https://wiki.wireshark.org/TLS#using-the-pre-master-secret\&quot;&gt;&lt;u&gt;SSLKEYLOGFILE&lt;/u&gt;&lt;/a&gt;) and/or detailed trace logging. Look for patterns of frequent or repeated frames that might be similar to malicious traffic. Adjusting your client may help avoid it getting misclassified as an attacker.&lt;/p&gt;&lt;p&gt;If you use Go, we recommend always reading HTTP/2 response bodies (even if empty) in order to avoid sending unnecessary RST_STREAM and PING frames. This is especially important if you use a single connection for multiple requests, which can cause a high frequency of these frames.&lt;/p&gt;&lt;p&gt;This was also a great reminder of the advantages of dogfooding our own products within our internal services. When we run into issues like this one, our learnings can benefit our customers with similar setups.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6doWYOkW3zbafkANt31knv/b00387716b1971d61eb8b4915ee58783/image5.png\&quot; alt=\&quot;\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;946\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-10-31T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-10-31T13:00:15.774Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5tdlwnVq6WLw1sQlM7ZaOr/686c8bb12f440cfd4c0619726c70a992/image4.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;3lxBe7kJ3IDjqgqMaBU1QJ&quot;],&quot;name&quot;:[0,&quot;HTTP2&quot;],&quot;slug&quot;:[0,&quot;http2&quot;]}],[0,{&quot;id&quot;:[0,&quot;KDI5hQcs301H8vxpGKXO0&quot;],&quot;name&quot;:[0,&quot;Go&quot;],&quot;slug&quot;:[0,&quot;go&quot;]}],[0,{&quot;id&quot;:[0,&quot;64g1G2mvZyb6PjJsisO09T&quot;],&quot;name&quot;:[0,&quot;DDoS&quot;],&quot;slug&quot;:[0,&quot;ddos&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Lucas Pardue&quot;],&quot;slug&quot;:[0,&quot;lucas&quot;],&quot;bio&quot;:[0,&quot;HTTP/2, HTTP/3 and QUIC @Cloudflare. IETF QUIC WG Co-Chair. I write some words, some code and occasionally speak.&quot;],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1k0fbniT2p2wjRfMognV4V/dca8d2e3a3e7fa4e24d7ddd9832eff1d/lucas.jpg&quot;],&quot;location&quot;:[0,&quot;London&quot;],&quot;website&quot;:[0,null],&quot;twitter&quot;:[0,&quot;@SimmerVigor&quot;],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Zak Cutner&quot;],&quot;slug&quot;:[0,&quot;zak&quot;],&quot;bio&quot;:[0,null],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/81LwAwcC86m7Q9fOpRGHF/220ea16c0b726ef68f1775ad62b8e7e8/Zak_Cutner_.jpeg&quot;],&quot;location&quot;:[0,null],&quot;website&quot;:[0,&quot;https://zakcutner.uk&quot;],&quot;twitter&quot;:[0,null],&quot;facebook&quot;:[0,null],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;HTTP/2 implementations often respond to suspected attacks by closing the connection with an ENHANCE_YOUR_CALM error code. Learn how a common pattern of using Go&#39;s HTTP/2 client can lead to unintended errors and the solution to avoiding them.&quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/go-and-enhance-your-calm&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Go and enhance your calm- demolishing an HTTP:2 interop problem&quot;],&quot;description&quot;:[0,&quot;HTTP/2 implementations often respond to suspected attacks by closing the connection with an ENHANCE_YOUR_CALM error code. Learn how a common pattern of using Go&#39;s HTTP/2 client can lead to unintended errors and the solution to avoiding them.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1DG8SxacSPHWzKabWjZNmg/c9675c4b3c498a4d232c8cb135f3bc2a/Go_and_enhance_your_calm-_demolishing_an_HTTP_2_interop_problem-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}],[0,{&quot;id&quot;:[0,&quot;1vU4Xmgau85ysMJVxTEx09&quot;],&quot;title&quot;:[0,&quot;Defending QUIC from acknowledgement-based DDoS attacks&quot;],&quot;slug&quot;:[0,&quot;defending-quic-from-acknowledgement-based-ddos-attacks&quot;],&quot;excerpt&quot;:[0,&quot;We identified and patched two DDoS vulnerabilities in our QUIC implementation related to packet acknowledgements. Cloudflare customers were not affected. We examine the \&quot;Optimistic ACK\&quot; attack vector and our solution, which dynamically skips packet numbers to validate client behavior. &quot;],&quot;featured&quot;:[0,false],&quot;html&quot;:[0,&quot;&lt;p&gt;&lt;/p&gt;&lt;p&gt;On April 10th, 2025 12:10 UTC, a security researcher notified Cloudflare of two vulnerabilities (&lt;a href=\&quot;https://www.cve.org/CVERecord?id=CVE-2025-4820\&quot;&gt;&lt;u&gt;CVE-2025-4820&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://www.cve.org/CVERecord?id=CVE-2025-4821\&quot;&gt;&lt;u&gt;CVE-2025-4821&lt;/u&gt;&lt;/a&gt;) related to QUIC packet acknowledgement (ACK) handling, through our &lt;a href=\&quot;https://hackerone.com/cloudflare?type=team\&quot;&gt;&lt;u&gt;Public Bug Bounty&lt;/u&gt;&lt;/a&gt; program. These were DDoS vulnerabilities in the &lt;a href=\&quot;https://github.com/cloudflare/quiche\&quot;&gt;&lt;u&gt;quiche&lt;/u&gt;&lt;/a&gt; library, and Cloudflare services that use it. quiche is Cloudflare&amp;#39;s open-source implementation of QUIC protocol, which is the transport protocol behind &lt;a href=\&quot;https://blog.cloudflare.com/http3-the-past-present-and-future/\&quot;&gt;&lt;u&gt;HTTP/3&lt;/u&gt;&lt;/a&gt;.&lt;/p&gt;&lt;p&gt;Upon notification, Cloudflare engineers patched the affected infrastructure, and the researcher confirmed that the DDoS vector was mitigated. &lt;b&gt;Cloudflare’s investigation revealed no evidence that the vulnerabilities were being exploited or that any customers were affected.&lt;/b&gt; quiche versions prior to 0.24.4 were affected.&lt;/p&gt;&lt;p&gt;Here, we’ll explain why ACKs are important to Internet protocol design and how they help ensure fair network usage. Finally, we will explain the vulnerabilities and discuss our mitigation for the Optimistic ACK attack: a dynamic CWND-aware skip frequency that scales with a connection’s send rate.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;internet-protocols-and-attack-vectors\&quot;&gt;Internet Protocols and Attack Vectors&lt;/h3&gt;\n      &lt;a href=\&quot;#internet-protocols-and-attack-vectors\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;QUIC is an Internet transport protocol that offers equivalent features to &lt;a href=\&quot;https://www.cloudflare.com/learning/ddos/glossary/tcp-ip/\&quot;&gt;&lt;u&gt;TCP&lt;/u&gt;&lt;/a&gt; (Transmission Control Protocol) and &lt;a href=\&quot;https://www.cloudflare.com/learning/ssl/transport-layer-security-tls/\&quot;&gt;&lt;u&gt;TLS&lt;/u&gt;&lt;/a&gt; (Transport Layer Security). QUIC runs over &lt;a href=\&quot;https://www.cloudflare.com/en-gb/learning/ddos/glossary/user-datagram-protocol-udp/\&quot;&gt;&lt;u&gt;UDP&lt;/u&gt;&lt;/a&gt; (User Datagram Protocol), is encrypted by default and offers a few benefits over the prior set of protocols (including smaller handshake time, connection migration, and preventing &lt;a href=\&quot;https://en.wikipedia.org/wiki/Head-of-line_blocking\&quot;&gt;&lt;u&gt;head-of-line blocking&lt;/u&gt;&lt;/a&gt; that can manifest in TCP). Similar to TCP, QUIC relies on packet acknowledgements to make general progress. For example, ACKs are used for liveliness checks, validation, loss recovery signals, and congestion algorithm signals.&lt;/p&gt;&lt;p&gt;ACKs are an important source of signals for Internet protocols, which necessitates validation to ensure a malicious peer is not subverting these signals. Cloudflare&amp;#39;s QUIC implementation, quiche, lacked ACK range validation, which meant a peer could send an ACK range for packets never sent by the endpoint; this was patched in &lt;a href=\&quot;https://www.cve.org/CVERecord?id=CVE-2025-4821\&quot;&gt;&lt;u&gt;CVE-2025-4821&lt;/u&gt;&lt;/a&gt;. Additionally, a sophisticated attacker could  mount an attack by predicting and preemptively sending ACKs (a technique called Optimistic ACK); this was patched in &lt;a href=\&quot;https://www.cve.org/CVERecord?id=CVE-2025-4820\&quot;&gt;&lt;u&gt;CVE-2025-4820&lt;/u&gt;&lt;/a&gt;. By exploiting the lack of ACK validation, an attacker can cause an endpoint to artificially expand its send rate; thereby gaining an unfair advantage over other connections. In the extreme case this can be a DDoS attack vector caused by higher server CPU utilization and an amplification of network traffic.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;fairness-and-congestion-control\&quot;&gt;Fairness and Congestion control&lt;/h3&gt;\n      &lt;a href=\&quot;#fairness-and-congestion-control\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;A typical CDN setup includes hundreds of server processes, serving thousands of concurrent connections. Each connection has its own recovery and congestion control algorithm that is responsible for determining its fair share of the network. The Internet is a shared resource that relies on well-behaved transport protocols correctly implementing congestion control to ensure fairness.&lt;/p&gt;&lt;p&gt;To illustrate the point, let’s consider a shared network where the first connection (blue) is operating at capacity. When a new connection (green) joins and probes for capacity, it will trigger packet loss, thereby signaling the blue connection to reduce its send rate. The probing can be highly dynamic and although convergence might take time, the hope is that both connections end up sharing equal capacity on the network.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/44jjkcx22rpD7VdnZKsnPD/4d514e73c885a729bd973b3efb2564bf/image4.jpg\&quot; alt=\&quot;New connection joining the shared network. Existing flows make room for the new flow.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1999\&quot; height=\&quot;704\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;New connection joining the shared network. Existing flows make room for the new flow.&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;In order to ensure fairness and performance, each endpoint uses a &lt;a href=\&quot;http://blog.cloudflare.com/cubic-and-hystart-support-in-quiche/\&quot;&gt;&lt;u&gt;Congestion Control&lt;/u&gt;&lt;/a&gt; algorithm. There are various algorithms but for our purposes let&amp;#39;s consider &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9438.html\&quot;&gt;&lt;u&gt;Cubic&lt;/u&gt;&lt;/a&gt;, a loss-based algorithm. Cubic, when in steady state, periodically explores higher sending rates. As the peer ACKs new packets, Cubic unlocks additional sending capacity (congestion window) to explore even higher send rates. Cubic continues to increase its send rate until it detects congestion signals (e.g., packet loss), indicating that the network is potentially at capacity and the connection should lower its sending rate.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5FvyfLs39CrWnHv8JjiJkd/d44cc31229e4dafa062d607c4214cba0/image6.png\&quot; alt=\&quot;Cubic congestion control responding to loss on the network.\&quot; class=\&quot;kg-image\&quot; width=\&quot;872\&quot; height=\&quot;395\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Cubic congestion control responding to loss on the network.&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;the-role-of-acks\&quot;&gt;The role of ACKs&lt;/h3&gt;\n      &lt;a href=\&quot;#the-role-of-acks\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;ACKs are a feedback mechanism that Internet protocols use to make progress. A server serving a large file download will send that data across multiple packets to the client. Since networks are lossy, the client is responsible for ACKing when it has received a packet from the server, thus confirming delivery and progress. Lack of an ACK indicates that the packet has been lost and that the data might require retransmission. This feedback allows the server to confirm when the client has received all the data that it requested.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1LMkCz6BB4aUav8pVhM1Mb/30f94cdaa857a08af3b8c0b9bb24de91/Screenshot_2025-10-28_at_15.23.05.png\&quot; alt=\&quot;The server delivers packets and the client responds with ACKs.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1404\&quot; height=\&quot;746\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;The server delivers packets and the client responds with ACKs.&lt;/sup&gt;&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3Sa33xjYHj52KZZTL4ITWv/d0347affc68318b36da988331c55fd6c/Screenshot_2025-10-28_at_15.23.38.png\&quot; alt=\&quot;The server delivers packets, but packet [2] is lost. The client responds with ACKs only for packets [1, 3], thereby signalling that packet [2] was lost.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1416\&quot; height=\&quot;734\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;The server delivers packets, but packet [2] is lost. The client responds with ACKs only for packets [1, 3], thereby signalling that packet [2] was lost.&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;In QUIC, packet numbers don&amp;#39;t have to be sequential; that means skipping packet numbers is natively supported. Additionally, a &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9000.html#name-ack-frames\&quot;&gt;&lt;u&gt;QUIC ACK Frame&lt;/u&gt;&lt;/a&gt; can contain gaps and multiple ACK ranges. As we will see, the built-in support for skipping packet numbers is a unique feature of QUIC (over TCP) that will help us enforce ACK validation.&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2azePr06Z0kGVQwdEaaqbx/5ab6844b4d515444393ab0b8ca33bf1d/Screenshot_2025-10-28_at_15.25.05.png\&quot; alt=\&quot;The server delivering packets, but skipping packet [4]. The client responds with ACKs only for packets it received, and not sending an ACK for packet [4].\&quot; class=\&quot;kg-image\&quot; width=\&quot;1418\&quot; height=\&quot;830\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;The server delivering packets, but skipping packet [4]. The client responds with ACKs only for packets it received, and not sending an ACK for packet [4].&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;ACKs also provide signals that control an endpoint&amp;#39;s send rate and help provide fairness and performance. Delay between ACKs, variations in the delay, and lack of ACKs provide valuable signals, which suggest a change in the network and are important inputs to a congestion control algorithm.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;skipping-packets-to-avoid-ack-delay\&quot;&gt;Skipping packets to avoid ACK delay&lt;/h3&gt;\n      &lt;a href=\&quot;#skipping-packets-to-avoid-ack-delay\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;QUIC allows endpoints to encode the ACK delay: the time by which the ACK for packet number &amp;#39;X&amp;#39; was intentionally delayed from when the endpoint received packet number &amp;#39;X.&amp;#39; This delay can result from normal packet processing or be an implementation-specific optimization. For example, since ACKs processing can be expensive (both for CPU and network), delaying ACKs can allow for batching and reducing the associated overhead.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;If the sender wants to elicit a faster acknowledgement on PTO, it can skip a packet number to eliminate the acknowledgement delay. -- &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9002.html#section-6.2.4\&quot;&gt;https://www.rfc-editor.org/rfc/rfc9002.html#section-6.2.4&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;However, since a delay in ACK signal also delays peer feedback, this can be detrimental for loss recovery. QUIC endpoints can therefore signal the peer to avoid delaying an ACK packet by skipping a packet number. This detail will become important as we will see later in the post.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;validating-ack-range\&quot;&gt;Validating ACK range&lt;/h3&gt;\n      &lt;a href=\&quot;#validating-ack-range\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;It is expected that a well-behaved client should only send ACKs for packets that it has received. A lack of validation meant that it was possible for the client to send a very large ACK range for packets never sent by the server. For example, assuming the server has sent packets 0-5, a client was able to send an ACK Frame with the range 0-100.&lt;/p&gt;&lt;p&gt;By itself this is not actually a huge deal since quiche is smart enough to drop larger ACKs and only process ACKs for packets it has sent. However, as we will see in the next section, this made the Optimistic ACK vulnerability easier to exploit.&lt;/p&gt;&lt;p&gt;The fix was to enforce ACK range validation based on the largest packets sent by the server and close the connection on violation. This matches the RFC recommendation.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;An endpoint SHOULD treat receipt of an acknowledgment for a packet it did not send as a connection error of type PROTOCOL_VIOLATION, if it is able to detect the condition. -- &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9000#section-13.1\&quot;&gt;https://www.rfc-editor.org/rfc/rfc9000#section-13.1&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/aPajmSD1NWaWvFv2aXAhs/480054b6514f3a1ddad219e4e81388f5/Screenshot_2025-10-28_at_15.26.15.png\&quot; alt=\&quot;The server validating ACKs: the client sending ACK for packets [4..5] not sent by the server. The server closes the connection since ACK validation fails.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1418\&quot; height=\&quot;904\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;The server validating ACKs: the client sending ACK for packets [4..5] not sent by the server. The server closes the connection since ACK validation fails.&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;optimistic-ack-attack\&quot;&gt;Optimistic ACK attack&lt;/h3&gt;\n      &lt;a href=\&quot;#optimistic-ack-attack\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;In the following scenario, let’s assume the client is trying to mount an Optimistic ACK attack against the server. The goal of a client mounting the attack is to cause the server to send at a high rate. To achieve a high send rate, the client needs to deliver ACKs quickly back to the server, thereby providing an artificially low &lt;a href=\&quot;https://www.cloudflare.com/learning/cdn/glossary/round-trip-time-rtt/\&quot;&gt;&lt;u&gt;RTT&lt;/u&gt;&lt;/a&gt; / high bandwidth signal. Since packet numbers are typically monotonically increasing, a clever client can predict the next packet number and preemptively send ACKs (artificial ACK).&lt;/p&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2xCY6yXFysB3yPxfa4TjOb/962a74feaf95e520abf037bd12e19db7/Screenshot_2025-10-28_at_15.28.39.png\&quot; alt=\&quot;Optimistic ACK attack: the client predicting packets sent by the server and preemptively sending ACKs. ACK validation does not help here.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1422\&quot; height=\&quot;714\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Optimistic ACK attack: the client predicting packets sent by the server and preemptively sending ACKs. ACK validation does not help here.&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;If the server has proper ACK validation, an invalid ACK for packets not yet sent by the server should trigger a connection close (without ACK range validation, the attack is trivial to execute). Therefore, a malicious client needs to be clever about pacing the artificial ACKs so they arrive just as the server has sent the packet. If the attack is done correctly, the server will see a very low RTT, and result in an inflated send rate.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;An endpoint that acknowledges packets it has not received might cause a congestion controller to permit sending at rates beyond what the network supports. An endpoint MAY skip packet numbers when sending packets to detect this behavior. An endpoint can then immediately close the connection with a connection error of type PROTOCOL_VIOLATION -- &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9000#section-21.4\&quot;&gt;https://www.rfc-editor.org/rfc/rfc9000#section-21.4&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;\n          &lt;figure class=\&quot;kg-card kg-image-card\&quot;&gt;\n          &lt;Image src=\&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/2fppvXzvdTOugNzCtxgiH5/897da7f980f1de95bdafa1aee423dcf2/Screenshot_2025-10-28_at_15.40.37.png\&quot; alt=\&quot;Preventing an Optimistic ACK attack: the client predicting packets sent by the server and preemptively sending ACKs. Since the server skipped packet [4], it is able to detect the invalid ACK and close the connection.\&quot; class=\&quot;kg-image\&quot; width=\&quot;1452\&quot; height=\&quot;830\&quot; loading=\&quot;lazy\&quot;/&gt;\n          &lt;/figure&gt;&lt;p&gt;&lt;sup&gt;Preventing an Optimistic ACK attack: the client predicting packets sent by the server and preemptively sending ACKs. Since the server skipped packet [4], it is able to detect the invalid ACK and close the connection.&lt;/sup&gt;&lt;/p&gt;&lt;p&gt;The &lt;a href=\&quot;https://www.rfc-editor.org/rfc/rfc9000#section-21.4\&quot;&gt;&lt;u&gt;QUIC RFC&lt;/u&gt;&lt;/a&gt; mentions the Optimistic ACK attack and suggests skipping packets to detect this attack. By skipping packets, the client is unable to easily predict the next packet number and risks connection close if the server implements invalid ACK range validation. Implementation details – like how many packet numbers to skip and how often – are missing, however.&lt;/p&gt;&lt;p&gt;The [malicious] client transmission pattern does not indicate any malicious behavior.&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;As such, the bit rate towards the server follows normal behavior. Considering that QUIC packets are end-to-end encrypted, a middlebox cannot identify the attack by analyzing the client’s traffic. -- &lt;a href=\&quot;https://louisna.github.io/files/2025-anrw-oack.pdf\&quot;&gt;MAY is not enough! QUIC servers SHOULD skip packet numbers&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;Ideally, the client would like to use as few resources as possible, while simultaneously causing the server to use as many as possible. In fact, as the security researchers confirmed in their paper: it is difficult to detect a malicious QUIC client using external traffic analysis, and it’s therefore necessary for QUIC implementations to mitigate the Optimistic ACK attack by skipping packets.&lt;/p&gt;&lt;p&gt;The Optimistic ACK vulnerability is not unique to QUIC. In fact the vulnerability was first discovered against TCP. However, since TCP does not natively support skipping packet numbers, an Optimistic ACK attack in TCP is harder to mitigate and can require additional DDoS analysis. By allowing for packet skipping, QUIC is able to prevent this type of attack at the protocol layer and more effectively ensure correctness and fairness over untrusted networks.&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;how-often-to-skip-packet-numbers\&quot;&gt;How often to skip packet numbers&lt;/h3&gt;\n      &lt;a href=\&quot;#how-often-to-skip-packet-numbers\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;According to the QUIC RFC, skipping packet numbers currently has two purposes. The first is to elicit a faster acknowledgement for loss recovery and the second is to mitigate an Optimistic ACK attack. A QUIC implementation skipping packets for Optimistic ACK attack therefore needs to skip frequently enough to mitigate the attack, while considering the effects on eliminating ACK delay.&lt;/p&gt;&lt;p&gt;Since packet skipping needs to be unpredictable, a simple implementation could be to skip packet numbers based on a random number from a static range. However, since the number of packets increases as the send rate increases, this has the downside of not adapting to the send rate. At smaller send rates, a static range will be too frequent, while at higher send rates it won&amp;#39;t be frequent enough and therefore be less effective. It&amp;#39;s also arguably most important to validate the send rate when there are higher send rates. It therefore seems necessary to adapt the skip frequency based on the send rate.&lt;/p&gt;&lt;p&gt;Congestion window (CWND) is a parameter used by congestion control algorithms to determine the amount of bytes that can be sent per round. Since the send rate increases based on the amount of bytes ACKed (capped by bytes sent), we claim that CWND makes a great proxy for dynamically adjusting the skip frequency. This CWND-aware skip frequency allows all connections, regardless of current send rate, to effectively mitigate the Optimistic ACK attack.&lt;/p&gt;\n            &lt;pre class=\&quot;language-Rust\&quot;&gt;&lt;code class=\&quot;language-Rust\&quot;&gt;// c: the current packet number\n// s: range of random packet number to skip from\n//\n// curr_pn\n//  |\n//  v                 |--- (upper - lower) ---|\n// [c x x x x x x x x s s s s s s s s s s s s s x x]\n//    |--min_skip---| |------skip_range-------|\n\nconst DEFAULT_INITIAL_CONGESTION_WINDOW_PACKETS: usize = 10;\nconst MIN_SKIP_COUNTER_VALUE: u64 = DEFAULT_INITIAL_CONGESTION_WINDOW_PACKETS * 2;\n\nlet packets_per_cwnd = (cwnd / max_datagram_size) as u64;\nlet lower = packets_per_cwnd / 2;\nlet upper = packets_per_cwnd * 2;\n\nlet skip_range = upper - lower;\nlet rand_skip_value = rand(skip_range);\n\nlet skip_pn = MIN_SKIP_COUNTER_VALUE + lower + rand_skip_value;&lt;/pre&gt;&lt;/code&gt;\n            &lt;p&gt;&lt;sup&gt;Skip frequency calculation in quiche.&lt;/sup&gt;&lt;/p&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;timeline\&quot;&gt;Timeline&lt;/h3&gt;\n      &lt;a href=\&quot;#timeline\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;All timestamps are in UTC.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;&lt;p&gt;2025–04-10 12:10 - Cloudflare is notified of an ACK validation and Optimistic ACK vulnerability via the Bug Bounty Program.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2025-04-19 00:20 – Cloudflare confirms both vulnerabilities are reproducible and begins working on fix.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2025-05-02 20:12 - Security patch is complete and infrastructure patching starts.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;2025–05-16 04:52 - Cloudflare infrastructure patching is complete.&lt;/p&gt;&lt;/li&gt;&lt;li&gt;&lt;p&gt;New quiche version released.&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;\n    &lt;div class=\&quot;flex anchor relative\&quot;&gt;\n      &lt;h3 id=\&quot;conclusion\&quot;&gt;Conclusion&lt;/h3&gt;\n      &lt;a href=\&quot;#conclusion\&quot; aria-hidden=\&quot;true\&quot; class=\&quot;relative sm:absolute sm:-left-5\&quot;&gt;\n        &lt;svg width=\&quot;16\&quot; height=\&quot;16\&quot; viewBox=\&quot;0 0 24 24\&quot;&gt;&lt;path fill=\&quot;currentcolor\&quot; d=\&quot;m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z\&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n      &lt;/a&gt;\n    &lt;/div&gt;\n    &lt;p&gt;We would like to sincerely thank &lt;a href=\&quot;https://louisna.github.io/\&quot;&gt;&lt;u&gt;Louis Navarre&lt;/u&gt;&lt;/a&gt; and &lt;a href=\&quot;https://perso.uclouvain.be/olivier.bonaventure/blog/html/pages/bio.html\&quot;&gt;&lt;u&gt;Olivier Bonaventure&lt;/u&gt;&lt;/a&gt; from &lt;a href=\&quot;https://www.uclouvain.be/en\&quot;&gt;&lt;u&gt;UCLouvain&lt;/u&gt;&lt;/a&gt;, who responsibly disclosed this issue via our &lt;a href=\&quot;https://www.cloudflare.com/en-gb/disclosure/\&quot;&gt;&lt;u&gt;Cloudflare Bug Bounty Program&lt;/u&gt;&lt;/a&gt;, allowing us to identify and mitigate the vulnerability. They also published a &lt;a href=\&quot;https://louisna.github.io/publication/2025-anrw-oack\&quot;&gt;&lt;u&gt;paper&lt;/u&gt;&lt;/a&gt; with their findings, notifying 10 other QUIC implementations that also suffered from the Optimistic ACK vulnerability. &lt;/p&gt;&lt;p&gt;We welcome further &lt;a href=\&quot;https://www.cloudflare.com/en-gb/disclosure/\&quot;&gt;&lt;u&gt;submissions&lt;/u&gt;&lt;/a&gt; from our community of researchers to continually improve the security of all of our products and open source projects.&lt;/p&gt;&quot;],&quot;published_at&quot;:[0,&quot;2025-10-29T13:00+00:00&quot;],&quot;updated_at&quot;:[0,&quot;2025-10-29T13:00:09.718Z&quot;],&quot;feature_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/18MZMfdTRXFChkErmLkwO6/78ff39914921e97769772d3532850bba/image3.png&quot;],&quot;tags&quot;:[1,[[0,{&quot;id&quot;:[0,&quot;1x7tpPmKIUCt19EDgM1Tsl&quot;],&quot;name&quot;:[0,&quot;Research&quot;],&quot;slug&quot;:[0,&quot;research&quot;]}],[0,{&quot;id&quot;:[0,&quot;76HSdQ6sNz56VVQXRUhhSw&quot;],&quot;name&quot;:[0,&quot;QUIC&quot;],&quot;slug&quot;:[0,&quot;quic&quot;]}],[0,{&quot;id&quot;:[0,&quot;7ihMshJdu4QleFdxzaQA87&quot;],&quot;name&quot;:[0,&quot;Protocols&quot;],&quot;slug&quot;:[0,&quot;protocols&quot;]}],[0,{&quot;id&quot;:[0,&quot;2pFyOCtANFB5qS6nbtQbVp&quot;],&quot;name&quot;:[0,&quot;Vulnerabilities&quot;],&quot;slug&quot;:[0,&quot;vulnerabilities&quot;]}],[0,{&quot;id&quot;:[0,&quot;6Mp7ouACN2rT3YjL1xaXJx&quot;],&quot;name&quot;:[0,&quot;Security&quot;],&quot;slug&quot;:[0,&quot;security&quot;]}]]],&quot;relatedTags&quot;:[0],&quot;authors&quot;:[1,[[0,{&quot;name&quot;:[0,&quot;Apoorv Kothari&quot;],&quot;slug&quot;:[0,&quot;apoorv-kothari&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5vJoqC1l0jby5BdUD0Nl29/749926bbdfbda551b32b82e5d7496217/Apoorv_Kothari.jpeg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}],[0,{&quot;name&quot;:[0,&quot;Louis Navarre (Guest author)&quot;],&quot;slug&quot;:[0,&quot;louis-navarre-guest-author&quot;],&quot;bio&quot;:[0],&quot;profile_image&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/26eJEkUImG8N7qAhwVvB49/85bf71ee1d9e8a0052c08162456ccbe5/image9.jpg&quot;],&quot;location&quot;:[0],&quot;website&quot;:[0],&quot;twitter&quot;:[0],&quot;facebook&quot;:[0],&quot;publiclyIndex&quot;:[0,true]}]]],&quot;meta_description&quot;:[0,&quot;We identified and patched two DDoS vulnerabilities in our QUIC implementation related to packet acknowledgements. Cloudflare customers were not affected. We examine the \&quot;Optimistic ACK\&quot; attack vector and our solution, which dynamically skips packet numbers to validate client behavior. &quot;],&quot;primary_author&quot;:[0,{}],&quot;localeList&quot;:[0,{&quot;name&quot;:[0,&quot;blog-english-only&quot;],&quot;enUS&quot;:[0,&quot;English for Locale&quot;],&quot;zhCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhHansCN&quot;:[0,&quot;No Page for Locale&quot;],&quot;zhTW&quot;:[0,&quot;No Page for Locale&quot;],&quot;frFR&quot;:[0,&quot;No Page for Locale&quot;],&quot;deDE&quot;:[0,&quot;No Page for Locale&quot;],&quot;itIT&quot;:[0,&quot;No Page for Locale&quot;],&quot;jaJP&quot;:[0,&quot;No Page for Locale&quot;],&quot;koKR&quot;:[0,&quot;No Page for Locale&quot;],&quot;ptBR&quot;:[0,&quot;No Page for Locale&quot;],&quot;esLA&quot;:[0,&quot;No Page for Locale&quot;],&quot;esES&quot;:[0,&quot;No Page for Locale&quot;],&quot;enAU&quot;:[0,&quot;No Page for Locale&quot;],&quot;enCA&quot;:[0,&quot;No Page for Locale&quot;],&quot;enIN&quot;:[0,&quot;No Page for Locale&quot;],&quot;enGB&quot;:[0,&quot;No Page for Locale&quot;],&quot;idID&quot;:[0,&quot;No Page for Locale&quot;],&quot;ruRU&quot;:[0,&quot;No Page for Locale&quot;],&quot;svSE&quot;:[0,&quot;No Page for Locale&quot;],&quot;viVN&quot;:[0,&quot;No Page for Locale&quot;],&quot;plPL&quot;:[0,&quot;No Page for Locale&quot;],&quot;arAR&quot;:[0,&quot;No Page for Locale&quot;],&quot;nlNL&quot;:[0,&quot;No Page for Locale&quot;],&quot;thTH&quot;:[0,&quot;No Page for Locale&quot;],&quot;trTR&quot;:[0,&quot;No Page for Locale&quot;],&quot;heIL&quot;:[0,&quot;No Page for Locale&quot;],&quot;lvLV&quot;:[0,&quot;No Page for Locale&quot;],&quot;etEE&quot;:[0,&quot;No Page for Locale&quot;],&quot;ltLT&quot;:[0,&quot;No Page for Locale&quot;]}],&quot;url&quot;:[0,&quot;https://blog.cloudflare.com/defending-quic-from-acknowledgement-based-ddos-attacks&quot;],&quot;metadata&quot;:[0,{&quot;title&quot;:[0,&quot;Defending QUIC from acknowledgement-based DDoS attacks&quot;],&quot;description&quot;:[0,&quot;We identified and patched two DDoS vulnerabilities in our QUIC implementation related to packet acknowledgements. Cloudflare customers were not affected. We examine the \&quot;Optimistic ACK\&quot; attack vector and our solution, which dynamically skips packet numbers to validate client behavior.&quot;],&quot;imgPreview&quot;:[0,&quot;https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3S5zS0efnFQquhrqi2yP3K/fe46906a5077987a132963462a303dbd/Defending_QUIC_from_acknowledgement-based_DDoS_attacks-OG.png&quot;]}],&quot;publicly_index&quot;:[0,true]}]]],&quot;locale&quot;:[0,&quot;en-us&quot;],&quot;translations&quot;:[0,{&quot;posts.by&quot;:[0,&quot;By&quot;],&quot;footer.gdpr&quot;:[0,&quot;GDPR&quot;],&quot;lang_blurb1&quot;:[0,&quot;This post is also available in {lang1}.&quot;],&quot;lang_blurb2&quot;:[0,&quot;This post is also available in {lang1} and {lang2}.&quot;],&quot;lang_blurb3&quot;:[0,&quot;This post is also available in {lang1}, {lang2} and {lang3}.&quot;],&quot;footer.press&quot;:[0,&quot;Press&quot;],&quot;header.title&quot;:[0,&quot;The Cloudflare Blog&quot;],&quot;search.clear&quot;:[0,&quot;Clear&quot;],&quot;search.filter&quot;:[0,&quot;Filter&quot;],&quot;search.source&quot;:[0,&quot;Source&quot;],&quot;footer.careers&quot;:[0,&quot;Careers&quot;],&quot;footer.company&quot;:[0,&quot;Company&quot;],&quot;footer.support&quot;:[0,&quot;Support&quot;],&quot;footer.the_net&quot;:[0,&quot;theNet&quot;],&quot;search.filters&quot;:[0,&quot;Filters&quot;],&quot;footer.our_team&quot;:[0,&quot;Our team&quot;],&quot;footer.webinars&quot;:[0,&quot;Webinars&quot;],&quot;page.more_posts&quot;:[0,&quot;More posts&quot;],&quot;posts.time_read&quot;:[0,&quot;{time} min read&quot;],&quot;search.language&quot;:[0,&quot;Language&quot;],&quot;footer.community&quot;:[0,&quot;Community&quot;],&quot;footer.resources&quot;:[0,&quot;Resources&quot;],&quot;footer.solutions&quot;:[0,&quot;Solutions&quot;],&quot;footer.trademark&quot;:[0,&quot;Trademark&quot;],&quot;header.subscribe&quot;:[0,&quot;Subscribe&quot;],&quot;footer.compliance&quot;:[0,&quot;Compliance&quot;],&quot;footer.free_plans&quot;:[0,&quot;Free plans&quot;],&quot;footer.impact_ESG&quot;:[0,&quot;Impact/ESG&quot;],&quot;posts.follow_on_X&quot;:[0,&quot;Follow on X&quot;],&quot;footer.help_center&quot;:[0,&quot;Help center&quot;],&quot;footer.network_map&quot;:[0,&quot;Network Map&quot;],&quot;header.please_wait&quot;:[0,&quot;Please Wait&quot;],&quot;page.related_posts&quot;:[0,&quot;Related posts&quot;],&quot;search.result_stat&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt; for &lt;strong&gt;{search_keyword}&lt;/strong&gt;&quot;],&quot;footer.case_studies&quot;:[0,&quot;Case Studies&quot;],&quot;footer.connect_2024&quot;:[0,&quot;Connect 2024&quot;],&quot;footer.terms_of_use&quot;:[0,&quot;Terms of Use&quot;],&quot;footer.white_papers&quot;:[0,&quot;White Papers&quot;],&quot;footer.cloudflare_tv&quot;:[0,&quot;Cloudflare TV&quot;],&quot;footer.community_hub&quot;:[0,&quot;Community Hub&quot;],&quot;footer.compare_plans&quot;:[0,&quot;Compare plans&quot;],&quot;footer.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.contact_sales&quot;:[0,&quot;Contact Sales&quot;],&quot;header.email_address&quot;:[0,&quot;Email Address&quot;],&quot;page.error.not_found&quot;:[0,&quot;Page not found&quot;],&quot;footer.developer_docs&quot;:[0,&quot;Developer docs&quot;],&quot;footer.privacy_policy&quot;:[0,&quot;Privacy Policy&quot;],&quot;footer.request_a_demo&quot;:[0,&quot;Request a demo&quot;],&quot;page.continue_reading&quot;:[0,&quot;Continue reading&quot;],&quot;footer.analysts_report&quot;:[0,&quot;Analyst reports&quot;],&quot;footer.for_enterprises&quot;:[0,&quot;For enterprises&quot;],&quot;footer.getting_started&quot;:[0,&quot;Getting Started&quot;],&quot;footer.learning_center&quot;:[0,&quot;Learning Center&quot;],&quot;footer.project_galileo&quot;:[0,&quot;Project Galileo&quot;],&quot;pagination.newer_posts&quot;:[0,&quot;Newer Posts&quot;],&quot;pagination.older_posts&quot;:[0,&quot;Older Posts&quot;],&quot;posts.social_buttons.x&quot;:[0,&quot;Discuss on X&quot;],&quot;search.icon_aria_label&quot;:[0,&quot;Search&quot;],&quot;search.source_location&quot;:[0,&quot;Source/Location&quot;],&quot;footer.about_cloudflare&quot;:[0,&quot;About Cloudflare&quot;],&quot;footer.athenian_project&quot;:[0,&quot;Athenian Project&quot;],&quot;footer.become_a_partner&quot;:[0,&quot;Become a partner&quot;],&quot;footer.cloudflare_radar&quot;:[0,&quot;Cloudflare Radar&quot;],&quot;footer.network_services&quot;:[0,&quot;Network services&quot;],&quot;footer.trust_and_safety&quot;:[0,&quot;Trust &amp; Safety&quot;],&quot;header.get_started_free&quot;:[0,&quot;Get Started Free&quot;],&quot;page.search.placeholder&quot;:[0,&quot;Search Cloudflare&quot;],&quot;footer.cloudflare_status&quot;:[0,&quot;Cloudflare Status&quot;],&quot;footer.cookie_preference&quot;:[0,&quot;Cookie Preferences&quot;],&quot;header.valid_email_error&quot;:[0,&quot;Must be valid email.&quot;],&quot;search.result_stat_empty&quot;:[0,&quot;Results &lt;strong&gt;{search_range}&lt;/strong&gt; of &lt;strong&gt;{search_total}&lt;/strong&gt;&quot;],&quot;footer.connectivity_cloud&quot;:[0,&quot;Connectivity cloud&quot;],&quot;footer.developer_services&quot;:[0,&quot;Developer services&quot;],&quot;footer.investor_relations&quot;:[0,&quot;Investor relations&quot;],&quot;page.not_found.error_code&quot;:[0,&quot;Error Code: 404&quot;],&quot;search.autocomplete_title&quot;:[0,&quot;Insert a query. Press enter to send&quot;],&quot;footer.logos_and_press_kit&quot;:[0,&quot;Logos &amp; press kit&quot;],&quot;footer.application_services&quot;:[0,&quot;Application services&quot;],&quot;footer.get_a_recommendation&quot;:[0,&quot;Get a recommendation&quot;],&quot;posts.social_buttons.reddit&quot;:[0,&quot;Discuss on Reddit&quot;],&quot;footer.sse_and_sase_services&quot;:[0,&quot;SSE and SASE services&quot;],&quot;page.not_found.outdated_link&quot;:[0,&quot;You may have used an outdated link, or you may have typed the address incorrectly.&quot;],&quot;footer.report_security_issues&quot;:[0,&quot;Report Security Issues&quot;],&quot;page.error.error_message_page&quot;:[0,&quot;Sorry, we can&#39;t find the page you are looking for.&quot;],&quot;header.subscribe_notifications&quot;:[0,&quot;Subscribe to receive notifications of new posts:&quot;],&quot;footer.cloudflare_for_campaigns&quot;:[0,&quot;Cloudflare for Campaigns&quot;],&quot;header.subscription_confimation&quot;:[0,&quot;Subscription confirmed. Thank you for subscribing!&quot;],&quot;posts.social_buttons.hackernews&quot;:[0,&quot;Discuss on Hacker News&quot;],&quot;footer.diversity_equity_inclusion&quot;:[0,&quot;Diversity, equity &amp; inclusion&quot;],&quot;footer.critical_infrastructure_defense_project&quot;:[0,&quot;Critical Infrastructure Defense Project&quot;]}],&quot;localesAvailable&quot;:[1,[[0,&quot;zh-cn&quot;],[0,&quot;zh-tw&quot;],[0,&quot;fr-fr&quot;],[0,&quot;de-de&quot;],[0,&quot;ja-jp&quot;],[0,&quot;ko-kr&quot;],[0,&quot;pt-br&quot;],[0,&quot;es-es&quot;]]],&quot;footerBlurb&quot;:[0,&quot;Cloudflare&#39;s connectivity cloud protects &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/network-services/&#39; rel=&#39;noreferrer&#39;&gt;entire corporate networks&lt;/a&gt;, helps customers build &lt;a target=&#39;_blank&#39; href=&#39;https://workers.cloudflare.com/&#39; rel=&#39;noreferrer&#39;&gt;Internet-scale applications efficiently&lt;/a&gt;, accelerates any &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/performance/accelerate-internet-applications/&#39; rel=&#39;noreferrer&#39;&gt;website or Internet application&lt;/a&gt;, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/ddos/&#39; rel=&#39;noreferrer&#39;&gt;wards off DDoS attacks&lt;/a&gt;, keeps &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/application-security/&#39; rel=&#39;noreferrer&#39;&gt;hackers at bay&lt;/a&gt;, and can help you on &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/products/zero-trust/&#39; rel=&#39;noreferrer&#39;&gt;your journey to Zero Trust&lt;/a&gt;.&lt;br/&gt;&lt;br/&gt;Visit &lt;a target=&#39;_blank&#39; href=&#39;https://one.one.one.one/&#39; rel=&#39;noreferrer&#39;&gt;1.1.1.1&lt;/a&gt; from any device to get started with our free app that makes your Internet faster and safer.&lt;br/&gt;&lt;br/&gt;To learn more about our mission to help build a better Internet, &lt;a target=&#39;_blank&#39; href=&#39;https://www.cloudflare.com/learning/what-is-cloudflare/&#39; rel=&#39;noreferrer&#39;&gt;start here&lt;/a&gt;. If you&amp;apos;re looking for a new career direction, check out &lt;a target=&#39;_blank&#39; href=&#39;http://www.cloudflare.com/careers&#39; rel=&#39;noreferrer&#39;&gt;our open positions&lt;/a&gt;.&quot;]}" ssr client="load" opts="{&quot;name&quot;:&quot;Post&quot;,&quot;value&quot;:true}" await-children><main id="post" class="flex flex-row flex-wrap items-center justify-center pt2 pt4-l"><article class="post-full mw-100 ph3 ph0-l fs-20px"><h1 class="f6 f7-l fw4 gray1 pt1 pt3-l mb1">How Cloudflare auto-mitigated world record 3.8 Tbps DDoS attack</h1><p class="f3 fw5 gray5 db di-l mt2">2024-10-02</p><ul class="author-lists flex pl0 mt4"><li class="list flex items-center pr2 mb1-ns"><a href="/author/manish/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4u7fayYeIfvEDkEviluW6O/62548ae5a3f678a8e8f1ae566dbdb54d/manish.png" alt="Manish Arora" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/manish/" class="fw4 f3 no-underline black mr3">Manish Arora</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/shawn/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/5caDpqzavLG1OKlZHXEaIs/9b4f42d3fef571adc37e4b82ae725fb3/shawn.jpg" alt="Shawn Bohrer" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/shawn/" class="fw4 f3 no-underline black mr3">Shawn Bohrer</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/omer/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6TXRnB1v4ZHGiL3nRlvRTZ/e47fa218da976d21b5074229b33b9589/omer.png" alt="Omer Yoachimik" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/omer/" class="fw4 f3 no-underline black mr3">Omer Yoachimik</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/cody-doucette/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/6WuOIO745xQocmriRTJFpZ/07d50aba265e49e13f933cc2ee5681f0/cody-doucette.png" alt="Cody Doucette" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/cody-doucette/" class="fw4 f3 no-underline black mr3">Cody Doucette</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/alex-forster/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4pCN3DTLyeVoIeQ2amvqdy/dd9104d78b872da4184d71f64c4cb35c/alex-forster.png" alt="Alex Forster" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/alex-forster/" class="fw4 f3 no-underline black mr3">Alex Forster</a></div></li><li class="list flex items-center pr2 mb1-ns"><a href="/author/nick-wood/" class="static-avatar pr1"><img class="author-profile-image br-100 mr2" src="https://blog.cloudflare.com/cdn-cgi/image/format=auto,dpr=3,width=64,height=64,gravity=face,fit=crop,zoom=0.5/https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7qTZDAtaw85IDos0L7YfL/3cd3a86ddaf5d30884dbfb6b5a21d4cf/nick-wood.png" alt="Nick Wood" width="62" height="62"/></a><div class="author-name-tooltip"><a href="/author/nick-wood/" class="fw4 f3 no-underline black mr3">Nick Wood</a></div></li></ul><section class="post-full-content"><div class="mb2 gray5">9 min read</div><div class="mt4">This post is also available in <a href="/zh-cn/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">简体中文</a>, <a href="/fr-fr/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">Français</a>, <a href="/de-de/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">Deutsch</a>, <a href="/ja-jp/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">日本語</a>, <a href="/ko-kr/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">한국어</a>, <a href="/pt-br/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">Português</a>, <a href="/es-es/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">Español</a> and <a href="/zh-tw/how-cloudflare-auto-mitigated-world-record-3-8-tbps-ddos-attack">繁體中文</a>.</div><img class="mr2" src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/4oWX173TYNYhwBecZAf7lU/a9bc6be9b7687ba354e9db1f46f0e685/BLOG-2586_1.png" alt=""/><div class="post-content lh-copy gray1"><p>Since early September, <a href="https://developers.cloudflare.com/ddos-protection/about/components/#autonomous-edge"><u>Cloudflare&#39;s DDoS protection systems</u></a> have been combating a month-long campaign of hyper-volumetric L3/4 DDoS attacks. Cloudflare’s defenses mitigated over one hundred hyper-volumetric L3/4 DDoS attacks throughout the month, with many exceeding 2 billion packets per second (Bpps) and 3 terabits per second (Tbps). The largest attack peaked 3.8 Tbps — the largest ever disclosed publicly by any organization. Detection and mitigation was fully autonomous. The graphs below represent two separate attack events that targeted the same Cloudflare customer and were mitigated autonomously.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7hXUgmEd37kzZrMs0KPXLl/21a4779022bdff91f760dc66759eb955/BLOG-2586_2.png" alt="BLOG-2586 2" class="kg-image" width="1999" height="922" loading="lazy"/>
          </figure><p><sup><i>A mitigated 3.8 Terabits per second DDoS attack that lasted 65 seconds</i></sup></p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1uxvtlkdFoH6KU6waXxK3o/d17fe7cf0e33c20e64a47b3ca0e6ca63/BLOG-2586_3.png" alt="BLOG-2586 3" class="kg-image" width="1999" height="1076" loading="lazy"/>
          </figure><p><sup><i>A mitigated 2.14 billion packet per second DDoS attack that lasted 60 seconds</i></sup></p>
    <div class="flex anchor relative">
      <h2 id="cloudflare-customers-are-protected">Cloudflare customers are protected</h2>
      <a href="#cloudflare-customers-are-protected" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Cloudflare customers using Cloudflare’s HTTP reverse proxy services (e.g. <a href="https://developers.cloudflare.com/waf/"><u>Cloudflare WAF</u></a> and <a href="https://developers.cloudflare.com/cache/"><u>Cloudflare CDN</u></a>) are automatically protected.</p><p>Cloudflare customers using <a href="https://developers.cloudflare.com/spectrum/"><u>Spectrum</u></a> and <a href="https://developers.cloudflare.com/magic-transit/"><u>Magic Transit</u></a> are also automatically protected. Magic Transit customers can further optimize their protection by deploying <a href="https://developers.cloudflare.com/magic-firewall/"><u>Magic Firewall</u></a> rules to enforce a strict positive and negative security model at the packet layer.</p>
    <div class="flex anchor relative">
      <h2 id="other-internet-properties-may-not-be-safe">Other Internet properties may not be safe</h2>
      <a href="#other-internet-properties-may-not-be-safe" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>The scale and frequency of these attacks are unprecedented. Due to their sheer size and bits/packets per second rates, these attacks have the ability to take down unprotected Internet properties, as well as Internet properties that are protected by on-premise equipment or by cloud providers that just don’t have sufficient network capacity or global coverage to be able to handle these volumes alongside legitimate traffic without impacting performance. </p><p>Cloudflare, however, does have the network capacity, global coverage, and intelligent systems needed to absorb and automatically mitigate these monstrous attacks. </p><p>In this blog post, we will review the attack campaign and why its attacks are so severe. We will describe the anatomy of a Layer 3/4 DDoS attack, its objectives, and how attacks are generated. We will then proceed to detail how Cloudflare’s systems were able to autonomously detect and mitigate these monstrous attacks without impacting performance for our customers. We will describe the key aspects of our defenses, starting with how our systems generate real-time (dynamic) signatures to match the attack traffic all the way to how we leverage kernel features to drop packets at wire-speed.</p>
    <div class="flex anchor relative">
      <h2 id="campaign-analysis">Campaign analysis</h2>
      <a href="#campaign-analysis" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>We have observed this attack campaign targeting multiple customers in the financial services, Internet, and telecommunication industries, among others. This attack campaign targets bandwidth saturation as well as resource exhaustion of in-line applications and devices.</p><p>The attacks predominantly leverage <a href="https://www.cloudflare.com/learning/ddos/glossary/user-datagram-protocol-udp/"><u>UDP</u></a> on a fixed port, and originated from across the globe with larger shares coming from Vietnam, Russia, Brazil, Spain, and the US. </p><p>The high packet rate attacks appear to originate from multiple types of compromised devices, including MikroTik devices, DVRs, and Web servers, orchestrated to work in tandem and flood the target with exceptionally large volumes of traffic. The high bitrate attacks appear to originate from a large number of compromised ASUS home routers, likely exploited using <a href="https://censys.com/june-20-improper-authentication-vulnerability-in-asus-routers/"><u>a CVE 9.8 (Critical) vulnerability that was recently discovered by Censys</u></a>.</p><div style="margin-left:0pt;" dir="ltr" align="left">
    <figure class="table">
        <table class="ck-table-resized" style="border-collapse:collapse;border-style:none;">
            <colgroup>
                <col style="width:50%;" width="344">
                <col style="width:50%;" width="100">
            </colgroup>
            <tbody>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Russia</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">12.1%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Vietnam</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">11.6%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">United States</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">9.3%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Spain</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">6.5%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Brazil</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">4.7%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">France</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">4.7%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Romania</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">4.4%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Taiwan</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">3.4%</span></span></p>
                    </td>
                </tr>
                <tr style="height:19.5pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">United Kingdom</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">3.3%</span></span></p>
                    </td>
                </tr>
                <tr style="height:15.75pt;">
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">Italy</span></span></p>
                    </td>
                    <td style="border-color:#cccccc;border-width:0.75pt;overflow-wrap:break-word;overflow:hidden;padding:2pt;vertical-align:bottom;">
                        <p style="line-height:1.38;margin-bottom:0pt;margin-top:0pt;text-align:right;" dir="ltr"><span style="background-color:transparent;color:#000000;font-family:Arial,sans-serif;"><span style="font-style:normal;font-variant:normal;font-weight:400;text-decoration:none;vertical-align:baseline;white-space:pre-wrap;">2.8%</span></span></p>
                    </td>
                </tr>
            </tbody>
        </table>
    </figure>
</div><p><sup><i>Share of packets observed by source location</i></sup></p>
    <div class="flex anchor relative">
      <h2 id="anatomy-of-ddos-attacks">Anatomy of DDoS attacks</h2>
      <a href="#anatomy-of-ddos-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Before we discuss how Cloudflare automatically detected and mitigated the largest DDoS attacks ever seen, it‘s important to understand the basics of DDoS attacks. </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/7HLtAHnyjS33iiJAR1B9h9/2e1fc2cab871440fc95fa803989ae156/BLOG-2586_5.png" alt="BLOG-2586 5" class="kg-image" width="1190" height="830" loading="lazy"/>
          </figure><p><sup><i>Simplified diagram of a DDoS attack</i></sup></p><p>The goal of a <a href="https://www.cloudflare.com/learning/ddos/what-is-a-ddos-attack/"><u>Distributed Denial of Service (DDoS) attack</u></a> is to deny legitimate users access to a service. This is usually done by exhausting resources needed to provide the service. In the context of these recent Layer 3/4 DDoS attacks, that resource is CPU cycles and network bandwidth.</p>
    <div class="flex anchor relative">
      <h3 id="exhausting-cpu-cycles">Exhausting CPU cycles</h3>
      <a href="#exhausting-cpu-cycles" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Processing a packet consumes CPU cycles. In the case of regular (non-attack) traffic, a <i>legitimate</i> packet received by a service will cause that service to perform some action, and different actions require different amounts of CPU processing. However, before a packet is even delivered to a service there is per-packet work that needs to be done. Layer 3 packet headers need to be parsed and processed to deliver the packet to the correct machine and interface. Layer 4 packet headers need to be processed and routed to the correct socket (if any). There may be multiple additional processing steps that inspect every packet. Therefore, if an attacker sends at a high enough packet rate, then they can potentially saturate the available CPU resources, denying service to legitimate users.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/3aBbNG4Fc7TY6MTugLl3BE/064fb17761aebbce737a5a4518a14235/BLOG-2586_6.png" alt="BLOG-2586 6" class="kg-image" width="1200" height="675" loading="lazy"/>
          </figure><p>To defend against high packet rate attacks, you need to be able to inspect and discard the bad packets using as few CPU cycles as possible, leaving enough CPU to process the good packets. You can additionally acquire more, or faster, CPUs to perform the processing — but that can be a very lengthy process that bears high costs. </p>
    <div class="flex anchor relative">
      <h3 id="exhausting-network-bandwidth">Exhausting network bandwidth</h3>
      <a href="#exhausting-network-bandwidth" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Network bandwidth is the total amount of data per time that can be delivered to a server. You can think of bandwidth like a pipe to transport water. The amount of water we can deliver through a drinking straw is less than what we could deliver through a garden hose. If an attacker is able to push more garbage data into the pipe than it can deliver, then both the bad data <i>and</i> the good data will be discarded upstream, at the entrance to the pipe, and the DDoS is therefore successful.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/OehVItOhGfP9ApllRvDDM/fce73e6f375173a1a53bc22026e0b9b1/BLOG-2586_7.png" alt="BLOG-2586 7" class="kg-image" width="1200" height="675" loading="lazy"/>
          </figure><p>
Defending against attacks that can saturate network bandwidth can be difficult because there is very little that can be done if you are on the downstream side of the saturated pipe. There are really only a few choices: you can get a bigger pipe, you can potentially find a way to move the good traffic to a new pipe that isn’t saturated, or you can hopefully ask the upstream side of the pipe to stop sending some or all of the data into the pipe.</p>
    <div class="flex anchor relative">
      <h2 id="generating-ddos-attacks">Generating DDoS attacks</h2>
      <a href="#generating-ddos-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>If we think about what this means from the attackers point of view you realize there are similar constraints. Just as it takes CPU cycles to receive a packet, it also takes CPU cycles to create a packet. If, for example, the cost to send and receive a packet were equal, then the attacker would need an equal amount of CPU power to generate the attack as we would need to defend against it. In most cases this is not true — there is a cost asymmetry, as the attacker is able to generate packets using fewer CPU cycles than it takes to receive those packets. However, it is worth noting that generating attacks is not free and can require a large amount of CPU power.</p><p>Saturating network bandwidth can be even more difficult for an attacker. Here the attacker needs to be able to output more bandwidth than the target service has allocated. They actually need to be able to exceed the capacity of the receiving service. This is so difficult that the most common way to achieve a network bandwidth attack is to use a reflection/amplification attack method, for example a <a href="https://www.cloudflare.com/learning/ddos/dns-amplification-ddos-attack/"><u>DNS Amplification attack</u></a>. These attacks allow the attacker to send a small packet to an intermediate service, and the intermediate service will send a large packet to the victim.</p><p>In both scenarios, the attacker needs to acquire or gain access to many devices to generate the attack. These devices can be acquired in a number of different ways. They may be server class machines from cloud providers or hosting services, or they can be compromised devices like DVRs, routers, and webcams that have been infected with the attacker’s malware. These machines together form the botnet.</p>
    <div class="flex anchor relative">
      <h2 id="how-cloudflare-defends-against-large-attacks">How Cloudflare defends against large attacks</h2>
      <a href="#how-cloudflare-defends-against-large-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Now that we understand the fundamentals of how DDoS attacks work, we can explain how Cloudflare can defend against these attacks.</p>
    <div class="flex anchor relative">
      <h3 id="spreading-the-attack-surface-using-global-anycast">Spreading the attack surface using global anycast</h3>
      <a href="#spreading-the-attack-surface-using-global-anycast" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>The first not-so-secret ingredient is that Cloudflare’s network is built on <a href="https://www.cloudflare.com/learning/cdn/glossary/anycast-network/"><u>anycast</u></a>. In brief, anycast allows a single IP address to be advertised by multiple machines around the world. A packet sent to that IP address will be served by the closest machine. This means when an attacker uses their distributed botnet to launch an attack, the attack will be received in a distributed manner across the Cloudflare network. An infected DVR in Dallas, Texas will send packets to a Cloudflare server in Dallas. An infected webcam in London will send packets to a Cloudflare server in London.</p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/48tW6A6ACUT4Fd9h3l70F4/c6bcea8f037fc853477d0987c939e007/BLOG-2586_8.png" alt="BLOG-2586 8" class="kg-image" width="1999" height="1880" loading="lazy"/>
          </figure><p><sup><i>Anycast vs. Unicast networks</i></sup></p><p>Our anycast network additionally allows Cloudflare to allocate compute and bandwidth resources closest to the regions that need them the most. Densely populated regions will generate larger amounts of legitimate traffic, and the data centers placed in those regions will have more bandwidth and CPU resources to meet those needs. Sparsely populated regions will naturally generate less legitimate traffic, so Cloudflare data centers in those regions can be sized appropriately. Since attack traffic is mainly coming from compromised devices, those devices will tend to be distributed in a manner that matches normal traffic flows sending the attack traffic proportionally to datacenters that can handle it. And similarly, within the datacenter, traffic is distributed across multiple machines.</p><p>Additionally, for high bandwidth attacks, Cloudflare’s network has another advantage. A large proportion of traffic on the Cloudflare network does not consume bandwidth in a symmetrical manner. For example, an HTTP request to get a webpage from a site behind Cloudflare will be a relatively small incoming packet, but produce a larger amount of outgoing traffic back to the client. This means that the Cloudflare network tends to egress far more legitimate traffic than we receive. However, the network links and bandwidth allocated are symmetrical, meaning there is an abundance of ingress bandwidth available to receive volumetric attack traffic.</p>
    <div class="flex anchor relative">
      <h3 id="generating-real-time-signatures">Generating real-time signatures</h3>
      <a href="#generating-real-time-signatures" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>By the time you’ve reached an individual server inside a datacenter, the bandwidth of the attack has been distributed enough that none of the upstream links are saturated. That doesn’t mean the attack has been fully stopped yet, since we haven’t dropped the bad packets. To do that, we need to sample traffic, qualify an attack, and create rules to block the bad packets. </p><p>Sampling traffic and dropping bad packets is the job of our <a href="https://blog.cloudflare.com/l4drop-xdp-ebpf-based-ddos-mitigations/"><u>l4drop</u></a> component, which uses <a href="https://netdevconf.info/2.1/papers/Gilberto_Bertin_XDP_in_practice.pdf"><u>XDP (eXpress Data Path)</u></a> and leverages an extended version of the Berkeley Packet Filter known as <a href="https://blog.cloudflare.com/tag/ebpf/"><u>eBPF (extended BPF)</u></a>. This enables us to execute custom code in kernel space and process (drop, forward, or modify) each packet directly at the network interface card (NIC) level. This component helps the system drop packets efficiently without consuming excessive CPU resources on the machine. </p>
          <figure class="kg-card kg-image-card">
          <Image src="https://cf-assets.www.cloudflare.com/zkvhlag99gkb/1NUxGTvKFs5l6G2UCSxvqw/3632f6728f9361123169d9694c807f0b/BLOG-2586_9.png" alt="BLOG-2586 9" class="kg-image" width="1999" height="1362" loading="lazy"/>
          </figure><p><sup><i>Cloudflare DDoS protection system overview</i></sup></p><p>We use XDP to sample packets to look for suspicious attributes that indicate an attack. The samples include fields such as the source IP, source port, destination IP, destination port, protocol, TCP flags, sequence number, options, packet rate and more. This analysis is conducted by the <i>denial of service daemon (dosd).</i> <i>Dosd</i> holds our secret sauce. It has many <i>filters</i> which instruct it, based on our curated heuristics, when to initiate mitigation. To our customers, these filters are logically grouped by attack vectors and exposed as the <a href="https://developers.cloudflare.com/ddos-protection/managed-rulesets/"><u>DDoS Managed Rules</u></a>. Our customers can <a href="https://developers.cloudflare.com/ddos-protection/managed-rulesets/adjust-rules/"><u>customize their behavior</u></a> to some extent, as needed.</p><p>As it receives samples from XDP, dosd will generate multiple permutations of fingerprints for suspicious traffic patterns. Then, using a data streaming algorithm, dosd will identify the most optimal fingerprints to mitigate the attack. Once an attack is qualified, dosd will push a mitigation rule inline as an eBPF program to surgically drop the attack traffic. </p><p>The detection and mitigation of attacks by dosd is done at the server level, at the data center level and at the global level — and it’s all software defined. This makes our network extremely resilient and leads to almost instant mitigation. There are no out-of-path “scrubbing centers” or “scrubbing devices”. Instead, each server runs the full stack of the Cloudflare product suite including the DDoS detection and mitigation component. And it is all done autonomously. Each server also <i>gossips (multicasts)</i> mitigation instructions within a data center between servers, and globally between data centers. This ensures that whether an attack is localized or globally distributed, dosd will have already installed mitigation rules inline to ensure a robust mitigation.</p>
    <div class="flex anchor relative">
      <h2 id="strong-defenses-against-strong-attacks">Strong defenses against strong attacks</h2>
      <a href="#strong-defenses-against-strong-attacks" aria-hidden="true" class="relative sm:absolute sm:-left-5">
        <svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg>
      </a>
    </div>
    <p>Our software-defined, autonomous DDoS detection and mitigation systems run across our entire network. In this post we focused mainly on our dynamic fingerprinting capabilities, but our arsenal of defense systems is much larger. The <a href="https://developers.cloudflare.com/ddos-protection/tcp-protection/"><u>Advanced TCP Protection</u></a> system and <a href="https://developers.cloudflare.com/ddos-protection/dns-protection/"><u>Advanced DNS Protection</u></a> system work alongside our dynamic fingerprinting to identify sophisticated and highly randomized TCP-based DDoS attacks and also leverages statistical analysis to thwart complex DNS-based DDoS attacks. Our defenses also incorporate real-time threat intelligence, traffic profiling, and machine learning classification as part of our <a href="https://developers.cloudflare.com/ddos-protection/managed-rulesets/adaptive-protection/"><u>Adaptive DDoS Protection</u></a> to mitigate traffic anomalies. </p><p>Together, these systems, alongside the full breadth of the Cloudflare Security portfolio, are built atop of the Cloudflare network — one of the largest networks in the world — to ensure our customers are protected from the largest attacks in the world.</p></div></section><section class="post-full-content flex flex-row flex-wrap mw7 center mb4"><div class="post-content lh-copy w-100 gray1 bt b--gray8 pt4">Cloudflare's connectivity cloud protects <a target='_blank' href='https://www.cloudflare.com/network-services/' rel='noreferrer'>entire corporate networks</a>, helps customers build <a target='_blank' href='https://workers.cloudflare.com/' rel='noreferrer'>Internet-scale applications efficiently</a>, accelerates any <a target='_blank' href='https://www.cloudflare.com/performance/accelerate-internet-applications/' rel='noreferrer'>website or Internet application</a>, <a target='_blank' href='https://www.cloudflare.com/ddos/' rel='noreferrer'>wards off DDoS attacks</a>, keeps <a target='_blank' href='https://www.cloudflare.com/application-security/' rel='noreferrer'>hackers at bay</a>, and can help you on <a target='_blank' href='https://www.cloudflare.com/products/zero-trust/' rel='noreferrer'>your journey to Zero Trust</a>.<br/><br/>Visit <a target='_blank' href='https://one.one.one.one/' rel='noreferrer'>1.1.1.1</a> from any device to get started with our free app that makes your Internet faster and safer.<br/><br/>To learn more about our mission to help build a better Internet, <a target='_blank' href='https://www.cloudflare.com/learning/what-is-cloudflare/' rel='noreferrer'>start here</a>. If you&apos;re looking for a new career direction, check out <a target='_blank' href="https://www.cloudflare.com/careers" rel='noreferrer'>our open positions</a>.</div></section><astro-slot> <!--[if astro]>server-island-start<![endif]--><link rel="preload" as="fetch" href="/_server-islands/SocialLinks?e=default&p=&s=%7B%22default%22%3A%22+%3Csvg+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+viewBox%3D%5C%220+0+232px+52px%5C%22+fill%3D%5C%22none%5C%22+xmlns%3D%5C%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%5C%22%3E+%3Cdefs%3E+%3CclipPath+id%3D%5C%22skelly-clip%5C%22%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+rx%3D%5C%228%5C%22%3E%3C%2Frect%3E+%3C%2FclipPath%3E+%3ClinearGradient+id%3D%5C%22gradient%5C%22%3E+%3Cstop+offset%3D%5C%220%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-2%3B+-2%3B+1%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%2250%25%5C%22+stop-color%3D%5C%22%23E8E6E6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-1%3B+-1%3B+2%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%22100%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%220%3B+0%3B+3%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3C%2FlinearGradient%3E+%3C%2Fdefs%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+fill%3D%5C%22url%28%23gradient%29%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+clip-path%3D%5C%22url%28%23skelly-clip%29%5C%22%3E%3C%2Frect%3E+%3C%2Fsvg%3E+%22%7D" crossorigin="anonymous"><script type="module" data-astro-rerun data-island-id="36f72f85-6adc-4c79-acfd-6099a2116347">let response = await fetch('/_server-islands/SocialLinks?e=default&p=&s=%7B%22default%22%3A%22+%3Csvg+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+viewBox%3D%5C%220+0+232px+52px%5C%22+fill%3D%5C%22none%5C%22+xmlns%3D%5C%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%5C%22%3E+%3Cdefs%3E+%3CclipPath+id%3D%5C%22skelly-clip%5C%22%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+rx%3D%5C%228%5C%22%3E%3C%2Frect%3E+%3C%2FclipPath%3E+%3ClinearGradient+id%3D%5C%22gradient%5C%22%3E+%3Cstop+offset%3D%5C%220%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-2%3B+-2%3B+1%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%2250%25%5C%22+stop-color%3D%5C%22%23E8E6E6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%22-1%3B+-1%3B+2%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3Cstop+offset%3D%5C%22100%25%5C%22+stop-color%3D%5C%22%23F6F6F6%5C%22+stop-opacity%3D%5C%221%5C%22%3E+%3Canimate+attributeName%3D%5C%22offset%5C%22+dur%3D%5C%221s%5C%22+keyTimes%3D%5C%220%3B+0.25%3B+1%5C%22+repeatCount%3D%5C%22indefinite%5C%22+values%3D%5C%220%3B+0%3B+3%5C%22%3E%3C%2Fanimate%3E+%3C%2Fstop%3E+%3C%2FlinearGradient%3E+%3C%2Fdefs%3E+%3Crect+width%3D%5C%22232px%5C%22+height%3D%5C%2252px%5C%22+fill%3D%5C%22url%28%23gradient%29%5C%22+x%3D%5C%220%5C%22+y%3D%5C%220%5C%22+clip-path%3D%5C%22url%28%23skelly-clip%29%5C%22%3E%3C%2Frect%3E+%3C%2Fsvg%3E+%22%7D');
replaceServerIsland('36f72f85-6adc-4c79-acfd-6099a2116347', response);</script> </astro-slot><iframe sandbox="allow-scripts allow-popups allow-popups-to-escape-sandbox" title="cloudflare-tv-live-link" id="cloudflare-tv-embed" src="https://cloudflare.tv/embed/live.html" loading="lazy"></iframe><a href="/tag/ddos/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">DDoS</a><a href="/tag/attacks/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Attacks</a><a href="/tag/trends/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Trends</a><a href="/tag/security/" class="dib pl2 pr2 pt1 pb1 mb2 bg-gray8 no-underline blue3 f2 mr1">Security</a></article></main><div class="ph3 pv3"><div class=" flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="black fw5 f4 mt4">Follow on X</p></div><div class="w-100 pb2"><span>Shawn Bohrer</span><span class="ph1">|</span><a href="https://x.com/@bohrers" class="no-underline">@bohrers</a></div><div class="w-100 pb2"><span>Omer Yoachimik</span><span class="ph1">|</span><a href="https://x.com/@OmerYoahimik" class="no-underline">@OmerYoahimik</a></div><div class="w-100 pb2"><span>Alex Forster</span><span class="ph1">|</span><a href="https://x.com/@alex_forster" class="no-underline">@alex_forster</a></div><div class="w-100 pb2"><span>Cloudflare</span><span class="ph2">|</span><a href="https://x.com/@cloudflare" class="no-underline">@cloudflare</a></div></div></div><div data-testid="related-posts-section" class="pv4 ph3 ph0-l flex flex-row flex-wrap mw7 center"><div class="w-100 bt b--gray8"><p class="orange fw5 f4 mt4 ttu">Related posts</p></div><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-11-05T14:00+00:00">November 05, 2025  2:00 PM</p><a data-testid="related-posts-article-title" href="/workers-vpc-open-beta/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">How Workers VPC Services connects to your regional private networks from anywhere in the world</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Workers VPC Services enter open beta today. We look under the hood to see how Workers VPC connects your globally-deployed Workers to your regional private networks by using Cloudflare&#x27;s global network, while abstracting cross-cloud networking complexity.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- --> </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/thomas-gauvin/" class="fw5 f2 black no-underline">Thomas Gauvin</a><span class="fw5 f2 black no-underline">, </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/matt-alonso/" class="fw5 f2 black no-underline">Matt Alonso</a><span class="fw5 f2 black no-underline">, </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/eric-falcao/" class="fw5 f2 black no-underline">Eric Falcão</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/workers/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Workers<!-- -->,</a> </span><span><a href="/tag/workers-vpc/" class="no-underline f1 fw2 blue3 underline-hover">Workers VPC<!-- -->,</a> </span><span><a href="/tag/cloudflare-tunnel/" class="no-underline f1 fw2 blue3 underline-hover">Cloudflare Tunnel<!-- -->,</a> </span><span><a href="/tag/network/" class="no-underline f1 fw2 blue3 underline-hover">Network<!-- -->,</a> </span><span><a href="/tag/hybrid-cloud/" class="no-underline f1 fw2 blue3 underline-hover">Hybrid Cloud<!-- -->,</a> </span><span><a href="/tag/security/" class="no-underline f1 fw2 blue3 underline-hover">Security<!-- -->,</a> </span><span><a href="/tag/vpc/" class="no-underline f1 fw2 blue3 underline-hover">VPC<!-- -->,</a> </span><span><a href="/tag/private-network/" class="no-underline f1 fw2 blue3 underline-hover">Private Network</a> </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-11-03T13:00+00:00">November 03, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/fresh-insights-from-old-data-corroborating-reports-of-turkmenistan-ip/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Fresh insights from old data: corroborating reports of Turkmenistan IP unblocking and firewall testing</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">Cloudflare used historical data to investigate reports of potential new firewall tests in Turkmenistan. Shifts in TCP resets/timeouts across ASNs corroborate large-scale network control system changes.
<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- --> </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/luke/" class="fw5 f2 black no-underline">Luke Valenta</a><span class="fw5 f2 black no-underline">, </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/marwan/" class="fw5 f2 black no-underline">Marwan Fayed</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/cloudflare-radar/" class="no-underline f1 fw2 blue3 underline-hover">Radar<!-- -->,</a> </span><span><a href="/tag/research/" class="no-underline f1 fw2 blue3 underline-hover">Research<!-- -->,</a> </span><span><a href="/tag/internet-shutdown/" class="no-underline f1 fw2 blue3 underline-hover">Internet Shutdown<!-- -->,</a> </span><span><a href="/tag/internet-trends/" class="no-underline f1 fw2 blue3 underline-hover">Internet Trends<!-- -->,</a> </span><span><a href="/tag/trends/" class="no-underline f1 fw2 blue3 underline-hover">Trends<!-- -->,</a> </span><span><a href="/tag/consumer-services/" class="no-underline f1 fw2 blue3 underline-hover">Consumer Services</a> </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-10-31T13:00+00:00">October 31, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/go-and-enhance-your-calm/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Go and enhance your calm: demolishing an HTTP/2 interop problem</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">HTTP/2 implementations often respond to suspected attacks by closing the connection with an ENHANCE_YOUR_CALM error code. Learn how a common pattern of using Go&#x27;s HTTP/2 client can lead to unintended errors and the solution to avoiding them.<!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- --> </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/lucas/" class="fw5 f2 black no-underline">Lucas Pardue</a><span class="fw5 f2 black no-underline">, </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/zak/" class="fw5 f2 black no-underline">Zak Cutner</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/http2/" class="no-underline f1 fw2 blue3 underline-hover">HTTP2<!-- -->,</a> </span><span><a href="/tag/go/" class="no-underline f1 fw2 blue3 underline-hover">Go<!-- -->,</a> </span><span><a href="/tag/ddos/" class="no-underline f1 fw2 blue3 underline-hover">DDoS</a> </span></div></article><article data-testid="related-posts-article" class="w-100 w-100-m w-50-l ph3 mb4"><p data-testid="related-posts-article-date" class="f3 fw5 gray5" data-iso-date="2025-10-29T13:00+00:00">October 29, 2025  1:00 PM</p><a data-testid="related-posts-article-title" href="/defending-quic-from-acknowledgement-based-ddos-attacks/" class="no-underline gray1 f4 fw5"><h2 class="gray1 f4 fw5 mt2">Defending QUIC from acknowledgement-based DDoS attacks</h2></a><p data-testid="related-posts-article-excerpt" class="gray1 lh-copy">We identified and patched two DDoS vulnerabilities in our QUIC implementation related to packet acknowledgements. Cloudflare customers were not affected. We examine the &quot;Optimistic ACK&quot; attack vector and our solution, which dynamically skips packet numbers to validate client behavior. <!-- -->...</p><ul class="flex pl0 fw6 f2 mb3 flex flex-wrap"><span>By<!-- --> </span><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/apoorv-kothari/" class="fw5 f2 black no-underline">Apoorv Kothari</a><span class="fw5 f2 black no-underline">, </span></div></li><li class="list flex items-center" style="white-space:nowrap"><div class="author-name-tooltip"><a href="/author/louis-navarre-guest-author/" class="fw5 f2 black no-underline">Louis Navarre (Guest author)</a></div></li></ul><div data-testid="related-posts-article-tags" class="flex flex-row flex-wrap"><span><a href="/tag/research/" class="no-underline f1 fw2 blue3 underline-hover">Research<!-- -->,</a> </span><span><a href="/tag/quic/" class="no-underline f1 fw2 blue3 underline-hover">QUIC<!-- -->,</a> </span><span><a href="/tag/protocols/" class="no-underline f1 fw2 blue3 underline-hover">Protocols<!-- -->,</a> </span><span><a href="/tag/vulnerabilities/" class="no-underline f1 fw2 blue3 underline-hover">Vulnerabilities<!-- -->,</a> </span><span><a href="/tag/security/" class="no-underline f1 fw2 blue3 underline-hover">Security</a> </span></div></article></div><!--astro:end--></astro-island><footer class="pt4 pb4 pl1 pr1 main-footer"><div class="mw8 center dn db-l ph3"><div class="flex flex-row justify-between"><div class="main-footer__menu-group"><ul id="getting-started-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="getting-started-menu">Getting Started<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/free/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="free-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Free plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/enterprise/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="enterprise" class="f1 blue3 no-underline underline-hover" rel="noreferrer">For enterprises</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compare-plans" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compare plans</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-your-website/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="get-a-recommendation" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Get a recommendation</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/demo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="request-a-demo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Request a demo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/plans/enterprise/contact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="contact-sales" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Contact Sales</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1" data-submenu="company-menu">Resources<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/learning/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="learning-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Learning Center</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/analysts/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="analysts-report" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Analyst reports</a></li><li class="pt1 pb1"><a href="https://radar.cloudflare.com/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Radar</a></li><li class="pt1 pb1"><a href="https://cloudflare.tv/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="tv" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare TV</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/case-studies/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="case-studies" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Case Studies</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Webinar" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="webinars" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Webinars</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/resource-hub/?resourcetype=Whitepaper" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="white-papers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">White Papers</a></li><li class="pt1 pb1"><a href="https://developers.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-docs" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer docs</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/the-net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="theNet" class="f1 blue3 no-underline underline-hover" rel="noreferrer">theNet</a></li></ul></div><div class="main-footer__menu-group"><ul id="sales-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="sales-menu">Solutions<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connectivity-cloud/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connectivity-cloud" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connectivity cloud</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/zero-trust/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="zero-trust" class="f1 blue3 no-underline underline-hover" rel="noreferrer">SSE and SASE services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/application-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="application-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Application services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network-services/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network services</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/developer-platform/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="developer-services" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Developer services</a></li></ul></div><div class="main-footer__menu-group"><ul id="community-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="community-menu">Community<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://community.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="community_hub" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Community Hub</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/galileo/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="galileo" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Project Galileo</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/athenian/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="athenian" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Athenian Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/campaigns/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="cloudflare-for-campaigns" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare for Campaigns</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/technology-partners/cidp/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="critical-infrastructure-defense-project" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Critical Infrastructure Defense Project</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/connect2024/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="connect-2024" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Connect 2024</a></li></ul></div><div class="main-footer__menu-group"><ul id="support-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="support-menu">Support<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://support.cloudflare.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="help-center" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Help center</a></li><li class="pt1 pb1"><a href="https://www.cloudflarestatus.com" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="status" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Cloudflare Status</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/compliance/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="compliance" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Compliance</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/gdpr/introduction/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="gdpr" class="f1 blue3 no-underline underline-hover" rel="noreferrer">GDPR</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/trust-hub/abuse-approach/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="trust-and-safety" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Trust &amp; Safety</a></li></ul></div><div class="main-footer__menu-group"><ul id="company-menu" class="list pl0"><li class="pt1 pb1 f1 main-footer__menu-group__header js-toggle-footer-group" data-submenu="company-menu">Company<i class="icon-caret-down"></i></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/about-overview/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="overview" class="f1 blue3 no-underline underline-hover" rel="noreferrer">About Cloudflare</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/people/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="our_team" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Our team</a></li><li class="pt1 pb1"><a href="https://cloudflare.net/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="investor-relations" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Investor relations</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Press</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/careers/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="careers" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Careers</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/diversity-equity-and-inclusion/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="diversity-equity-inclusion" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Diversity, equity &amp; inclusion</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/impact/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="impact-ESG" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Impact/ESG</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/network/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="network_map" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Network Map</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/press-kit/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="press-kit" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Logos &amp; press kit</a></li><li class="pt1 pb1"><a href="https://www.cloudflare.com/partners/" target="_blank" data-tracking-category="footer" data-tracking-action="click" data-tracking-label="partners" class="f1 blue3 no-underline underline-hover" rel="noreferrer">Become a partner</a></li></ul></div></div></div><div class="mw8 center ph3"><div class="flex flex-row flex-wrap justify-center md:justify-between items-center pt4"><div class="flex flex-row space-x-4 items-start w-25-l pb4 pb0-l"><a target="_blank" rel="noreferrer" href="https://www.facebook.com/Cloudflare/" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/facebook.svg" alt="facebook"/></a><a target=" _blank" rel="noreferrer" href="https://x.com/Cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/twitter.svg" alt="X"/></a><a target="_blank" rel="noreferrer" href="https://www.linkedin.com/company/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/linkedin.svg" alt="linkedin"/></a><a target="_blank" rel="noreferrer" href="https://www.youtube.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/youtube.svg" alt="youtube"/></a><a target="_blank" rel="noreferrer" href="https://www.instagram.com/cloudflare" class="w-8"><img class="w-8" src="https://www.cloudflare.com/img/footer/instagram.svg" alt="instagram"/></a></div><div class="w-70-l tr-l tl-ns"><div><span class="main-footer__copyright f1">© <!-- -->2025<!-- --> Cloudflare, Inc.<!-- --> </span><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/privacypolicy/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Privacy Policy<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/website-terms/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Terms of Use<!-- --> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/disclosure/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Report Security Issues<!-- --> </a><span class="main-footer__copyright f1">|</span><img class="mw2 ph1" src="/images/privacy-options.svg" alt="Privacy Options"/><a href="#cookie-settings" id="ot-sdk-btn" class="ot-sdk-show-settings main-footer__copyright f1 no-underline underline-hover"><span class="brandGray5">Cookie Preferences</span> </a><span class="main-footer__copyright f1">|</span><a href="https://www.cloudflare.com/trademark/" target="_blank" class="main-footer__copyright f1 no-underline underline-hover" rel="noreferrer"> <!-- -->Trademark<!-- --> </a></div></div></div></div></footer></html>